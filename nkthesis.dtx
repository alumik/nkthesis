% \iffalse meta-comment
%
% Copyright 2025 Zhenyu Zhong
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   https://www.latex-project.org/lppl.txt
% and version 1.3c or later is part of all distributions of LaTeX
% version 2008 or later.
%
% \fi
%
% \iffalse
%<*driver>
\ProvidesFile{nkthesis.dtx}
%</driver>
%<class>\NeedsTeXFormat{LaTeX2e}[2024/11/01]
%<class>\RequirePackage{expl3}
%<class>\ProvidesExplClass
%<class>    {nkthesis}
%<class>    {2025/05/23}
%<class>    {v2.2.0}
%<class>    {Template for Master's and Doctoral Thesis of Nankai University}
%
%<*driver>
\PassOptionsToPackage{AutoFakeBold=true, AutoFakeSlant=true}{xeCJK}
\PassOptionsToPackage{hyphens}{url}
\documentclass{ctxdoc}
\usepackage{float}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{newunicodechar}
\newfontfamily{\dejavusans}{DejaVu Sans}
\newunicodechar{★}{{\dejavusans ★}}
\DefineVerbatimEnvironment{nkthesisexam}{Verbatim}{
    gobble=6,
    frame=single,
    framesep=10pt,
    label=\rule{0pt}{12pt}\textnormal{\textbf{例 \arabic{nkthesisexam}}},
    listparameters=
        \setlength{\topsep}{\bigskipamount}
        \refstepcounter{nkthesisexam}
}
\newcounter{nkthesisexam}
\EnableCrossrefs
\CodelineIndex
\RecordChanges
\begin{document}
    \DocInput{nkthesis.dtx}
\end{document}
%</driver>
% \fi
%
% \DoNotIndex{
%     \\, \addcontentsline, \arabic, \arraybackslash, \arraystretch,
%     \AtBeginBibliography, \baselineskip, \begin, \bfseries, \bool_if:NTF,
%     \bool_new:N, \captionsetup, \ccwd, \centering, \cftbeforechapskip,
%     \cftbeforefigskip, \cftbeforesecskip, \cftbeforesubsecskip,
%     \cftbeforetabskip, \cftchapfont, \cftchapleader, \cftchappagefont,
%     \cftdotfill, \cftdotsep, \cftfigfont, \cftfigindent, \cftfignumwidth,
%     \cftfigpresnum, \cftsecfont, \cftsecindent, \cftsecpagefont,
%     \cftsubsecfont, \cftsubsecindent, \cftsubsecpagefont, \cfttabfont,
%     \cfttabindent, \cfttabnumwidth, \cfttabpresnum, \chapter, \CTEXthesection,
%     \checkmark, \chinese, \clearpage, \clist_map_inline:nn, \cs_new:Nn,
%     \cs_set:Npn, \csname, \CTEXifname, \ctexset, \CTEXthechapter,
%     \DeclareCaptionFont, \DeclareCaptionLabelFormat, \PassOptionsToPackage,
%     \dim_eval:n, \dim_set:Nn, \draw, \end, \endcsname, \evensidemargin,
%     \fancyfoot, \fancyhead, \fancyhf, \fancyhfoffset, \floatsep, \fontsize,
%     \footskip, \foreach, \fp_eval:n, \fp_new:N, \fp_set:Nn, \getrefnumber,
%     \group_begin:, \group_end:, \hbox, \headheight, \headrulewidth, \headsep,
%     \hfill, \hline, \hspace, \hyperref, \IfEndWith, \ignorespaces,
%     \int_new:N, \intextsep, \keys_define:nn, \keys_set:nn, \labelformat,
%     \leftmark, \leq, \linespread, \linewidth, \LoadClass, \makebox, \markboth,
%     \NewDocumentCommand, \NewDocumentEnvironment,
%     \NewExpandableDocumentCommand, \newfontfamily, \newlist, \nobreakspace,
%     \noindent, \nouppercase, \oddsidemargin,
%     \pagenumbering, \pagestyle, \par, \parindent, \parskip, \prop_item:Nn,
%     \path, \printbibliography, \ProcessKeyOptions, \prop_if_in:NnTF,
%     \prop_new:N, \prop_put:Nnn, \protect, \qquad, \quad, \raggedbottom,
%     \raggedleft, \raggedright, \raisebox, \RenewDocumentCommand,
%     \RequirePackage, \scalebox, \selectfont, \setlist,
%     \singlespace, \square, \StrBehind, \subcaptionsetup, \setmainfont,
%     \tabcolsep, \@@italiccorr, \maketag@@@, \tagform@, \textbf, \textbullet,
%     \textfloatsep, \textheight, \textwidth, \thefigure, \thepage, \thetable,
%     \thispagestyle, \tl_if_empty:eTF, \tl_new:N, \tl_set:Nn, \tl_use:N,
%     \tocloftpagestyle, \today, \topmargin, \topskip, \underline, \unskip,
%     \vline, \vrule, \vspace, \x, \zihao, \ziju, \DeclareCaptionLabelSeparator,
% }
% \DoNotIndex{
%     \int_compare:nNnTF, \int_compare:nNnT, \str_if_eq:eeTF, \str_if_eq:eeF,
% }
% \DoNotIndex{
%     \RenewExpandableDocumentCommand, \apptocmd, \thechapter, \theequation,
%     \thesubfigure, \newunicodechar, \CJKfamily, \fontspec_font_if_exist:nTF,
%     \setCJKfamilyfont, \setCJKmainfont, \setCJKmonofont, \setCJKsansfont,
%     \AtBeginEnvironment, \int_gset:Nn, \c@secnumdepth, \c@page, \rule,
%     \bool_set_true:N, \bool_if:NF, \bool_if:NTF, \cleardoublepage,
%     \PassOptionsToClass, \MakeUppercase,
% }
%
% \changes{v2.0}{2025/04/30}
%     {重构为 \LaTeXiii 文档类，并以 \texttt{.dtx} 格式发布。}
% \changes{v2.1}{2025/05/01}{不再默认提供非开源字体文件。}
% \changes{v2.1}{2025/05/01}{需要最新版本的 \LaTeX2e（2024/11/01）以确保功能正常。}
%
% \title{^^A
%     \textbf{nkthesis：南开大学硕士/博士毕业（学位）论文模板}^^A
%     \thanks{适用于《研究生学位论文写作规范（2025版）》。}^^A
% }
% \author{钟震宇 \\ \texttt{zyzhong@mail.nankai.edu.cn}}
% \date{2025/05/23\qquad v2.2.0}
% \maketitle
%
% \begin{abstract}
%     \cls{nkthesis} 是一个全新编写的南开大学硕士/博士毕业（学位）论文 \LaTeX 模板，符合《研究生学位论文写作规范（2025版）》要求，支持 Windows 和 Overleaf平台使用 \XeLaTeX 编译。
%     该模板精简了类定义，同时保证了编译结果的一致性和规范性。
%     它提供了中文和数字两种标题编号样式选择，利用多个宏包协同工作实现定制化功能。
%     本模板提供了完善的中英文摘要、关键词、前言、符号说明、勘误表、致谢和个人简历等环境，以及题名页、匿名评阅封面、原创性声明、使用授权书和参考文献等特殊页面。
%     使用者可通过简单的命令设置和获取论文基本信息，调整字体字号和行间距，实现交叉引用和插入图片。
%     本模板代码开源，在 GitHub 上提供完整使用说明和持续更新。
% \end{abstract}
%
% \tableofcontents
%
% \bigskip
%
% \begin{documentation}
%
% \section{介绍}
%
% 本模板主要特点如下：
%
% \begin{enumerate}
%     \item 使用 \LaTeXiii 接口编写模板。
%     \item 符合《研究生学位论文写作规范（2025版）》。
%           目前仅支持中文论文。
%     \item 可按需添加需要的字体，保证不同平台编译结果的一致性。
%     \item 支持 Windows（\TeX Live 2025） 与 Overleaf 使用 \XeLaTeX 编译，其他环境未测试。
%     \item 实现了中文和数字两种标题编号样式。
%     \item 使用下列宏包实现大多数自定义功能：
%           \begin{itemize}
%               \item 使用 \CTeX 提供高阶中文支持。
%               \item 使用 \pkg{geometry} 自定义纸张大小。
%               \item 使用 \pkg{tocloft} 自定义目录样式。
%               \item 使用 \pkg{caption} 自定义图注、表注样式。
%               \item 使用 \pkg{fancyhdr} 自定义页眉页脚样式。
%               \item 使用 \pkg{fontspec} 设置自定义字体。
%               \item 使用 \pkg{enumitem} 自定义列表样式。
%               \item 使用 \pkg{hyperref} 自定义超链接样式。
%               \item 使用 \pkg{biblatex} 及其自带的 \texttt{gb7714-2015} 样式自定义参考文献样式。
%               \item 使用 \pkg{subcaption} 自定义子图样式。
%               \item 使用 \pkg{tikz} 绘制矢量版的南开大学文字 Logo。
%               \item 使用 \pkg{array} 自定义表格样式。
%           \end{itemize}
% \end{enumerate}
%
% \section{简明教程}
%
% \subsection{\cls{nkthesis} 的主要组成部分}
%
% 本模板主要包含核心文档类（表~\ref{tab:components-of-nkthesis-1}）和
% 示例文件（表~\ref{tab:components-of-nkthesis-2}）两个部分。
%
% \begin{table}[H]
%     \centering
%     \caption{\cls{nkthesis} 核心文档类}
%     \label{tab:components-of-nkthesis-1}
%     \begin{tabular}{ll}
%         \toprule
%         文件 & 功能说明 \\
%         \midrule
%         fonts/                    & 自定义字体，详见~\ref{subsec:fonts} 节 \\
%         LICENSE                   & 许可证                                 \\
%         nkthesis.dtx              & 文档类文件                             \\
%         nkthesis.ins              & 文档类安装文件                         \\
%         README.md                 & 简易使用说明                           \\
%         \bottomrule
%     \end{tabular}
% \end{table}
%
% \changes{v2.1}{2025/05/02}{将示例文件从 main 重命名为 nkthesis-sample。}
% \changes{v2.1}{2025/05/03}{将示例文件从 chapters 重命名为 mainmatter。}
%
% \begin{table}[H]
%     \centering
%     \caption{\cls{nkthesis} 示例文件}
%     \label{tab:components-of-nkthesis-2}
%     \begin{tabular}{ll}
%         \toprule
%         文件                & 功能说明                                             \\
%         \midrule
%         backmatter/         & 模板后置部分，包含附录、勘误页、致谢、个人简历       \\
%         frontmatter/        & 模板前置部分，包含中英文摘要、序言、符号缩略语注释表 \\
%         mainmatter/         & 模板主体部分，包含示例章节                           \\
%         latexmkrc           & 自动化编译配置                                       \\
%         nkthesis-sample.bib & 参考文献数据库                                       \\
%         nkthesis-sample.tex & 模板示例文档                                         \\
%         \bottomrule
%     \end{tabular}
% \end{table}
%
% \subsection{下载并安装 \cls{nkthesis}}
%
% \begin{enumerate}
%     \item 将本模板所有文件克隆/下载到本地。
%     \item 获取 nkthesis.cls 文件。
%           以下两种方法可任选其一：
%           \begin{enumerate}
%               \item[a）] 从 GitHub Release\footnote{\url{https://github.com/alumik/nkthesis/releases/latest}} 中下载最新版本的 nkthesis.cls 文件，放入论文文件夹中。
%               \item[b）] 使用以下命令从 nkthesis.dtx 文件中提取 nkthesis.cls 文件。
%                               \begin{nkthesisexam}
%     xelatex nkthesis.ins
%                               \end{nkthesisexam}
%           \end{enumerate}
%     \item 使用 \XeLaTeX 编译 nkthesis-sample.tex 示例文件。
%           本模板已经提供了 \pkg{latexmk} 配置文件，使用 |latexmk| 命令编译时会自动调用 \XeLaTeX。
%           \begin{nkthesisexam}
%     latexmk nkthesis-sample.tex
%           \end{nkthesisexam}
%           如果编译时出现如下所示的缺少字体错误，请参考~\ref{subsec:fonts} 节解决。
%           \begin{nkthesisexam}
%     Package fontspec Error:
%     (fontspec)	The font "simsun" cannot be found; this may be but
%     (fontspec)	usually is not a fontspec bug. Either there is a
%     (fontspec)	typo in the font name/file, the font is not
%     (fontspec)	installed (correctly), or there is a bug in the
%     (fontspec)	underlying font loading engine (XeTeX/luaotfload).
%           \end{nkthesisexam}
% \end{enumerate}
%
% \subsection{可选步骤：放置字体文件}
% \label{subsec:fonts}
%
% 本模板使用的“宋体”、“仿宋”、“楷书”、“黑体”字体文件为 Microsoft Windows 系统自带的中易字体。
% 此外，还使用了 Times New Roman 和 Arial 等非开源字体。
% 在 Windows 系统中，由于这些字体文件已经存在，因此不需要额外放置字体文件就可以直接编译本模板。
% 但在 Overleaf 等其他非 Windows 环境下，可能会缺少这些字体文件。
%
% 本模板不附带非开源字体。
% 缺少字体文件时，用户需要手动将以下字体文件放置在论文文件夹下的 fonts/ 文件夹中。
%
% \begin{table}[H]
%     \begin{tabular}{@{}rllll}
%         中易字体： & simsun.ttc & simfang.ttf & simhei.ttf & simkai.ttf \\
%         Times New Roman 字体： & times.ttf & timesbd.ttf & timesi.ttf & timesbi.ttf \\
%         Arial 字体： & arial.ttf & arialbd.ttf & ariali.ttf & arialbi.ttf \\
%     \end{tabular}
% \end{table}
%
% 一般情况下，这些字体文件可以在 Windows 系统的 C:\textbackslash Windows\textbackslash Fonts 目录下找到。
%
% \subsection{使用 \cls{nkthesis} 文档类}
%
% 本模板提供了一个中文文档类：\cls{nkthesis}。
% 使用它的时候，需要将涉及到的所有源文件使用 UTF-8 编码保存。
%
% \begin{nkthesisexam}
%     \documentclass{nkthesis}
%     \begin{document}
%     中文文档类测试。你需要将所有源文件保存为 UTF-8 编码。
%
%     你可以使用 XeLaTeX 编译。
%     \end{document}
% \end{nkthesisexam}
%
% \subsection{文档类选项}
%
% 本模板提供了以下文档类选项，可以作为可选参数传入 |\documentclass| 命令中。
%
% \begin{nkthesisexam}
%     \documentclass[<文档类选项>]{nkthesis}
% \end{nkthesisexam}
%
% \begin{function}{headingmode}
%     \begin{syntax}
%         headingmode = <1|(2)>
%     \end{syntax}
%     指定标题编号样式。
%     分别对应《规范》中的模式一（数字编号）和模式二（中文编号）。
% \end{function}
%     \begin{optdesc}[itemsep=\medskipamount]
%         \item[1] 模式一，数字编号模式。
%                  示例：
%
%                  1 ××××（章标题，左对齐）
%
%                  1.1 ××××（一级标题，左对齐）
%
%                  1.1.1 ××××（二级标题，左对齐）
%
%                  1.1.1.1 ××××（根据需要，也可设三级标题，左对齐）
%         \item[2] 模式二，中文编号模式。
%                  示例：
%
%                  第一章××××（章标题，居中）
%
%                  第一节××××（一级标题，居中）
%
%                  一、××××（二级标题，左缩进2个汉字）
%
%                  （一）××××（根据需要，也可设三级标题，左缩进2个汉字）
%     \end{optdesc}
%
% \begin{function}{uppercasehead}
%     当该选项存在时，将章节页眉转换为全大写。
%     否则，保留原始大小写。
% \end{function}
%
% \changes{v2.2}{2025/05/23}{添加使章节必须从奇数页开始的选项。}
%
% \begin{function}[added=2025/05/23]{openright}
%     当该选项存在时，章节开始时强制在右页开始。
%     该选项通常用于双面打印。
% \end{function}
%
% \section{设置和读取论文基本信息}
%
% \subsection{设置论文基本信息}
%
% \begin{function}{\nktset}
%     \begin{syntax}
%         \cs{nktset} \marg{键值列表}
%     \end{syntax}
%     用来设置论文基本信息。
%     \cs{nktset} 的参数是一组由逗号分隔的选项列表，以通用的接口完成各项设置。
%     列表中的选项通常是一个 \meta{key}|=|\meta{value} 格式的定义。
%     如果值内部含有逗号，需要使用大括号包裹逗号。
%     例如，设置论文标题与作者姓名就可以使用：
%
%     \begin{nkthesisexam}
%         \nktset{
%             论文题目（中文） = {现代绿色化学中的物理有机问题},
%             论文作者         = {张三}
%         }
%     \end{nkthesisexam}
% \end{function}
%
% \cs{nktset} 采用 \LaTeXiii 风格的键值设置，支持不同类型的选项与层次化的选项设置。
%
% 可配置的论文基本信息条目如下：
%
% \begin{function}{中图分类号}
%     \begin{syntax}
%         中图分类号 = <分类号>
%     \end{syntax}
%     中图分类号，暂空。
%     默认值为空。
% \end{function}
%
% \begin{function}{学校代码}
%     \begin{syntax}
%         学校代码 = <代码>
%     \end{syntax}
%     学校代码，填写“10055”，即南开大学。
%     默认值为“10055”。
% \end{function}
%
% \begin{function}{UDC}
%     \begin{syntax}
%         UDC = <UDC>
%     \end{syntax}
%     UDC号，暂空。
%     默认值为空。
% \end{function}
%
% \begin{function}{题名页/密级}
%     \begin{syntax}
%         题名页/密级 = <密级>
%     \end{syntax}
%     题名页中的“密级”字段。
%     默认值为“公开”。
%     按GB/T7156-2003《文献保密等级代码与标识》标注。
%     公开论文可以标注“公开”，也可不标注。
%     非公开论文标注“限制”、“秘密”或“机密”，同时还应注明相应的保密年限（具体标注要求见《研究生学位论文写作规范（2025版）》第三章第二节）。
% \end{function}
%
% \begin{function}{题名页/论文类别}
%     \begin{syntax}
%         题名页/论文类别 = <(硕士)|博士|硕士专业|博士专业>
%     \end{syntax}
%     学位（论文）类别，用于调整题名页展示的论文类别。
%     默认值为“硕士”。
% \end{function}
%     \begin{optdesc}[itemsep=\medskipamount]
%         \item[硕士] 题名页论文类别为“硕士学位论文”。
%         \item[博士] 题名页论文类别为“博士学位论文”。
%         \item[硕士专业] 题名页论文类别为“硕士专业学位论文”。
%         \item[博士专业] 题名页论文类别为“博士专业学位论文”。
%     \end{optdesc}
%
% \begin{function}{题名页/论文题目字号}
%     \begin{syntax}
%         题名页/论文题目字号 = <字号>
%     \end{syntax}
%     题名页中论文标题的字号。
%     默认值为“2”（二号）。
%     如果字数过多可适当调整。
% \end{function}
%
% \changes{v2.1}{2025/05/09}{去掉论文题目的默认值。}
%
% \begin{function}[updated=2025/05/09]{论文题目（中文）}
%     \begin{syntax}
%         论文题目（中文） = <名称>
%     \end{syntax}
%     论文中文标题。
%     默认值为空。
% \end{function}
%
% \begin{function}{论文副标题}
%     \begin{syntax}
%         论文副标题 = <名称>
%     \end{syntax}
%     论文中文副标题。
%     默认值为空。
%     如论文题目内容层次很多，难以简化时，可采用论文题目和论文副标题相结合的方法，其中副标题起补充、阐明题目的作用。
% \end{function}
%
% \changes{v2.1}{2025/05/09}{去掉论文题目的默认值。}
%
% \begin{function}[updated=2025/05/09]{论文题目（英文）}
%     \begin{syntax}
%         论文题目（英文） = <名称>
%     \end{syntax}
%     论文英文标题。
%     默认值为空。
% \end{function}
%
% \begin{function}{论文作者,指导教师,指导教师职称}
%     \begin{syntax}
%         论文作者 = <姓名>
%         指导教师 = <姓名>
%         指导教师职称 = <职称>
%     \end{syntax}
%     论文责任者信息。
%     默认值为空。
%     责任者信息包括论文作者姓名，指导教师姓名、职称等。
%     如责任者姓名有必要附注汉语拼音时，遵照GB/T16159-2012《汉语拼音正词法基本规则》著录。
% \end{function}
%
% \begin{function}{申请学位}
%     \begin{syntax}
%         申请学位 = <名称>
%     \end{syntax}
%     申请的学位名称。
%     默认值为空。
%     包括申请的学位类别和级别，学位类别标注包括以下门类：哲学、经济学、法学、教育学、文学、历史学、理学、工学、农学、医学、军事学、管理学、艺术学。
%     学位级别标注包括硕士、博士。
%     如哲学硕士、管理学博士。
%     硕士专业学位直接标注其名称，如工商管理硕士、工程硕士等。
% \end{function}
%
% \begin{function}{培养单位}
%     \begin{syntax}
%         培养单位 = <名称>
%     \end{syntax}
%     培养单位名称。
%     默认值为空。
%     指学位申请人所在学院（所）名称，应采用规范全称。
%     哲学院、数学科学学院等。
% \end{function}
%
% \begin{function}{一级学科}
%     \begin{syntax}
%         一级学科 = <名称>
%     \end{syntax}
%     一级学科名称。
%     默认值为空。
%     学科名称以国务院学位委员会颁布的《研究生教育学科专业目录（2022年）》为准。
%     硕士专业学位填写领域名称，如无领域不必填此项。
% \end{function}
%
% \begin{function}{二级学科}
%     \begin{syntax}
%         二级学科 = <名称>
%     \end{syntax}
%     二级学科名称。
%     默认值为空。
%     学科名称参照国务院学位委员会颁布的《授予博士、硕士学位和培养研究生的学科、专业目录》或南开大学自主设置学科名称。
%     若无二级学科，可不填此项。
% \end{function}
%
% \begin{function}{研究方向}
%     \begin{syntax}
%         研究方向 = <名称>
%     \end{syntax}
%     研究方向名称。
%     默认值为空。
%     指本学科专业范畴下的研究方向。
% \end{function}
%
% \begin{function}{答辩委员会主席}
%     \begin{syntax}
%         答辩委员会主席 = <姓名>
%     \end{syntax}
%     答辩委员会主席姓名。
%     默认值为空。
% \end{function}
%
% \begin{function}{评阅人}
%     \begin{syntax}
%         评阅人 = <姓名列表>
%     \end{syntax}
%     评阅人姓名列表。
%     默认值为空。
% \end{function}
%
% \begin{function}{论文完成时间}
%     \begin{syntax}
%         论文完成时间 = <日期>
%     \end{syntax}
%     中文大写格式的论文完成时间。
%     展示于题名页最下方。
%     默认值为当前日期。
%     应填写论文提交评审的时间。
% \end{function}
%
% \begin{function}{论文编号}
%     \begin{syntax}
%         论文编号 = <编号>
%     \end{syntax}
%     论文编号。
%     默认值为空。
% \end{function}
%
% \begin{function}{非公开论文/申请密级}
%     \begin{syntax}
%         非公开论文/申请密级 = <(公开)|限制|秘密|机密>
%     \end{syntax}
%     《非公开学位论文标注说明》中的申请密级。
%     默认值为“公开”。
% \end{function}
%     \begin{optdesc}[itemsep=\medskipamount]
%         \item[公开] 论文为公开类型。
%         \item[限制] 论文为限制类型。
%         \item[秘密] 论文为秘密类型。
%         \item[机密] 论文为机密类型。
%     \end{optdesc}
%
% \begin{function}{非公开论文/保密期限/起始日期,非公开论文/保密期限/结束日期}
%     \begin{syntax}
%         非公开论文/保密期限/起始日期 = <日期>
%     \end{syntax}
%     《非公开学位论文标注说明》中的保密期限起始日期和结束日期。
%
%     默认值为“20|\qquad{}|年|\qquad{}|月|\qquad{}|日”。
%     |\qquad{}| 仅用于默认值排版，实际填写时请写成例如“2025年06月29日”的形式。
% \end{function}
%
% \begin{function}{非公开论文/审批表编号}
%     \begin{syntax}
%         非公开论文/审批表编号 = <编号>
%     \end{syntax}
%     《非公开学位论文标注说明》中的审批表编号。
%     默认值为空。
% \end{function}
%
% \begin{function}{非公开论文/批准日期}
%     \begin{syntax}
%         非公开论文/批准日期 = <日期>
%     \end{syntax}
%     《非公开学位论文标注说明》中的批准日期。
%
%     默认值为“20|\qquad{}|年|\qquad{}|月|\qquad{}|日”。
%     |\qquad{}| 仅用于默认值排版，实际填写时请写成例如“2025年06月29日”的形式。
% \end{function}
%
% \begin{function}{授权书/签字日期}
%     \begin{syntax}
%         授权书/签字日期 = <日期>
%     \end{syntax}
%     《南开大学学位论文使用授权书》中的签字日期。
%
%     默认值为“20|\qquad{}|年|\qquad{}|月|\qquad{}|日”。
%     |\qquad{}| 仅用于默认值排版，实际填写时请写成例如“2025年06月29日”的形式。
% \end{function}
%
% \begin{function}{学号,联系电话,电子邮箱,通讯地址}
%     \begin{syntax}
%         学号 = <学号>
%         联系电话 = <电话号码>
%         电子邮箱 = <邮箱地址>
%         通讯地址 = <地址>
%     \end{syntax}
%     《南开大学研究生学位论文作者信息》中的作者信息。
%     默认值为空。
% \end{function}
%
% \begin{function}{答辩日期}
%     \begin{syntax}
%         答辩日期 = <日期>
%     \end{syntax}
%     答辩日期。
%
%     默认值为“20|\qquad{}|年|\qquad{}|月|\qquad{}|日”。
%     |\qquad{}| 仅用于默认值排版，实际填写时请写成例如“2025年06月29日”的形式。
% \end{function}
%
% \begin{function}{作者信息/备注}
%     \begin{syntax}
%         作者信息/备注 = <内容>
%     \end{syntax}
%     《南开大学研究生学位论文作者信息》中的备注。
%     默认值为空。
% \end{function}
%
% \begin{function}{作者信息/论文类别}
%     \begin{syntax}
%         作者信息/论文类别 = <博士|(学历硕士)|专业学位硕士|同等学力硕士>
%     \end{syntax}
%     《南开大学研究生学位论文作者信息》中的论文类别。
%     默认值为“学历硕士”。
% \end{function}
%     \begin{optdesc}[itemsep=\medskipamount]
%         \item[博士] 在《南开大学研究生学位论文作者信息》中勾选“博士”。
%         \item[学历硕士] 在《南开大学研究生学位论文作者信息》中勾选“学历硕士”。
%         \item[专业学位硕士] 在《南开大学研究生学位论文作者信息》中勾选“专业学位硕士”。
%         \item[同等学力硕士] 在《南开大学研究生学位论文作者信息》中勾选“同等学力硕士”。
%     \end{optdesc}
%
% \subsection{获取论文基本信息}
%
% \begin{function}{\nktget}
%     \begin{syntax}
%         \cs{nktget} \marg{键名}
%     \end{syntax}
%     用来获取论文基本信息。
% \end{function}
%
% 以下是获取学校代码的示例：
%
% \begin{nkthesisexam}
%     \nktget{学校代码}
% \end{nkthesisexam}
%
% \section{论文结构}
%
% 本文档类提供了多个自定义环境和自定义页面。
% 自定义环境可以通过以下方式使用，以在文中插入相应页面。
%
% \begin{nkthesisexam}
%     \begin{acknowledgements}
%         这是致谢内容
%     \end{acknowledgements}
% \end{nkthesisexam}
%
% 自定义页面可以通过以下方式直接使用，以在文中插入相应页面。
%
% \begin{nkthesisexam}
%     \titlepage
% \end{nkthesisexam}
%
% \subsection{整体结构}
%
% \changes{v2.1}{2025/05/02}{将示例文件从 main 重命名为 nkthesis-sample。}
% \changes{v2.1}{2025/05/03}{在文档中介绍论文的整体结构。}
%
% 论文结构可以参考 nkthesis-sample.tex 文件中的内容。
% 论文可以分为四个部分，即封面材料、前置部分（frontmatter）、主体部分（mainmatter）和后置部分（backmatter）。
% 推荐的整体结构如下：
%
% \begin{nkthesisexam}
%     \begin{document}
%
%     % 以下页面可根据需要（匿名/非匿名等）选择使用
%     \titlepage  % （非匿名）题名页
%     \anonymoustitlepage  % 匿名评阅封面
%     \declarationpage
%     \authorizationpage
%
%     \frontmatter
%
%     \begin{abstract}
%         中文摘要。
%     \end{abstract}
%
%     \begin{keywords}
%         中文关键词。
%     \end{keywords}
%
%     \begin{enabstract}
%         英文摘要。
%     \end{enabstract}
%
%     \begin{enkeywords}
%         英文关键词。
%     \end{enkeywords}
%
%     \begin{preface}
%         序言或前言。
%     \end{preface}
%
%     \tableofcontents
%     \listoffigures
%     \listoftables
%
%     \begin{symabbr}
%         符号、标志、缩略语等的注释表。
%     \end{symabbr}
%
%     \mainmatter
%
%     \chapter{章标题}
%     章内容。
%     \section{节标题}
%     节内容。
%     \subsection{小节标题}
%     小节内容。
%     \subsubsection{小小节标题}
%     小小节内容。
%
%     \backmatter
%
%     \appendix
%
%     \chapter{附录标题}
%     附录内容。
%
%     \bibliographypage
%
%     \begin{errata}
%         勘误页。
%     \end{errata}
%
%     \begin{acknowledgements}
%         致谢。
%     \end{acknowledgements}
%
%     % 以下页面可根据需要（匿名/非匿名等）选择使用
%     \begin{resume}
%         个人简历。
%     \end{resume}
%
%     \begin{resume*}
%         （匿名）个人简历。
%     \end{resume*}
%
%     \end{document}
% \end{nkthesisexam}
%
% \subsection{封面材料}
%
% 封面材料包括题名页、学位论文原创性声明和非公开学位论文标注说明、学位论文使用授权书等。
%
% \begin{function}{\titlepage}
%     题名页。
%     题名页包含论文全部书目信息。
% \end{function}
%
% \begin{function}{\anonymoustitlepage}
%     匿名评阅封面。
%     用于匿名评阅的论文。
%     该封面不包含作者姓名、学号、指导教师姓名等信息。
% \end{function}
%
% \begin{function}{\declarationpage}
%     学位论文原创性声明和非公开学位论文标注说明。
%     本部分放在题名页之后。
% \end{function}
%
% \begin{function}{\authorizationpage}
%     学位论文使用授权书。
%     本部分放在学位论文原创性声明之后。
% \end{function}
%
% \subsection{前置部分}
%
% \begin{function}{\frontmatter}
%     声明前置部分开始。
%     在本模板中，前置部分包含中英文摘要、序言或前言、目录、图和附表清单以及符号、标志、缩略语等的注释表等。
%     前置部分的页码采用大写罗马字母，并且与正文分开计数。
% \end{function}
%
% \noindent\DescribeEnv{abstract}
% 中文摘要。
%
% \noindent\DescribeEnv{keywords}
% 中文关键词。
% 中文关键词在中文摘要内容后另起一行标明，一般3-5个，之间用中文分号分开。
%
% \noindent\DescribeEnv{enabstract}
% 英文摘要（Abstract）。
%
% \noindent\DescribeEnv{enkeywords}
% 英文关键词。
% 英文关键词在英文摘要内容后另起一行标明，一般3-5个，之间用英文分号分开。
%
% \noindent\DescribeEnv{preface}
% 序言或前言。
% 学位论文的序言或前言一般是作者对本篇论文基本特征的简介，如说明研究工作的缘起、背景、主旨、目的、意义、编写体例，以及资助、支持、协作经过等。
% 这些内容也可以在正文引言（绪论）中说明。
%
% \begin{function}{\tableofcontents}
%     目录。
%     排在序言（或前言）之后，另起页。
%     目录是论文各章节标题的顺序列表，附有相应的起始页码。
% \end{function}
%
% \begin{function}{\listoffigures}
%     图清单。
%     论文中如图表较多，可以分别列出清单置于目录页之后另起页。
%     图的清单有序号、图题和页码。
% \end{function}
%
% \begin{function}{\listoftables}
%     表清单。
%     表的清单有序号、表题和页码。
% \end{function}
%
% \noindent\DescribeEnv{symabbr}
% 符号、标志、缩略语等的注释表。
% 符号、标志、缩略语、首字母缩写、计量单位、自定义名词和术语等的注释说明，如需汇集，应编写成注释说明汇集表，集中置于图表清单之后。
% 若上述符号使用数量不多，可以不设此部分，但必须在论文中出现时加以说明。
%
% \subsection{主体部分}
%
% \begin{function}{\mainmatter}
%     声明主体部分开始。
%     主体部分是论文的核心，可以分章节撰写。
%     如有需求，也可以采用多文件编译的方式。
%     主体部分的页码采用阿拉伯数字。
% \end{function}
%
% \subsection{后置部分}
%
% \begin{function}{\backmatter}
%     声明后置部分开始。
%     后置部分包含附录、参考文献、勘误页、致谢以及个人简历、在学期间发表的学术论文及研究成果等。
% \end{function}
%
% \begin{function}{\appendix}
%     声明附录部分开始。
%     附录放在正文之后。
% \end{function}
%
% \begin{function}{\bibliographypage}
%     参考文献。
% \end{function}
%
% \noindent\DescribeEnv{errata}
% 勘误页。
% 放在参考文献和分类索引、关键词索引后。
% 在勘误页顶部应放置下列信息：题名、副题名（如有）、作者名。
%
% \noindent\DescribeEnv{acknowledgements}
% 致谢。
% 致谢是作者对该文章的形成作过贡献的组织或个人予以感谢的文字记载，语言要诚恳、恰当、简短。
% 致谢应放置在参考文献和勘误页后。
%
% \noindent\DescribeEnv{resume}
% 个人简历、在学期间发表的学术论文及研究成果。
% 个人简历包括出生年月日、获得学士、硕士学位的学校、时间等；学术论文研究成果按发表的时间顺序列出（已发表的列在前面，已接收待发表的放在后面）；研究成果可以是在学期间参加的研究项目、申请的专利或获奖等。
%
% \noindent\DescribeEnv{resume*}
% 在学期间发表的学术论文及研究成果（用于匿名评阅版论文）。
%
% \section{排版格式设定}
%
% \subsection{字体字号}
%
% 正文中文默认使用小四号宋体，英文默认使用 12 磅 Times New Roman。
% 本模板还支持以下字体：
%
% \begin{function}{\songti}
%     宋体，CJK 等价命令 |\CJKfamily{zhsong}|。
% \end{function}
%
% \begin{function}{\heiti}
%     黑体，CJK 等价命令 |\CJKfamily{zhhei}|。
% \end{function}
%
% \begin{function}{\fangsong}
%     仿宋，CJK 等价命令 |\CJKfamily{zhfs}|。
% \end{function}
%
% \begin{function}{\kaishu}
%     楷书，CJK 等价命令 |\CJKfamily{zhkai}|。
% \end{function}
%
% \begin{function}{\arial}
%     英文无衬线字体，对应字体 Arial。
% \end{function}
%
% \begin{function}[added=2025/05/01]{\dejavusans}
%     符号字体，对应字体 DejaVu Sans。
% \end{function}
%
% 切换字体字号命令的使用示例如下。
% 最外侧的大括号可以限制字体设置的作用范围。
%
% \begin{nkthesisexam}
%     {\heiti{}\zihao{3}这是黑体三号字}
%     {\songti{}\zihao{-4}这是宋体小四号字}
%     {\fangsong{}\zihao{12}这是仿宋12磅字}
%     {\kaishu{}\zihao{5}这是楷书五号字}
% \end{nkthesisexam}
%
% 有以下几种特殊情况：
%
% \begin{itemize}
%     \item 由于宋体没有原生粗体，使用 |\textbf| 或 |\bfseries| 命令得到的会是黑体。
%     \item 如果想得到宋体的{\songti\textbf{伪粗体}}，可以使用 |\songti\textbf| 命令。
%     \item 由于宋体本身没有斜体，使用 |\textit| 或 |\itshape| 命令得到的会是楷书。
%     \item 如果想得到宋体的{\songti\textit{伪斜体}}，可以使用 |\songti\textit| 命令。
% \end{itemize}
%
% \subsection{行间距}
%
% 模板提供以下两个命令调整行间距。
% 在命令后均需要加上 |\selectfont| 命令来生效。
%
% \begin{function}{\mslinespread}
%     \begin{syntax}
%         \cs{mslinespread} \marg{行间距（倍数）}
%     \end{syntax}
%     模仿 Microsoft Word 中的“多倍行距”设置行间距。
% \end{function}
%
% \begin{function}{\mslinespreadbp}
%     \begin{syntax}
%         \cs{mslinespreadbp} \marg{行间距（磅）}
%     \end{syntax}
%     模仿 Microsoft Word 中的“固定行距”（单位：磅）设置行间距。
%     文档类正文行间距默认为固定20磅。
% \end{function}
%
% \begin{nkthesisexam}
%    {
%        \mslinespread{1.5}\selectfont  % 设置1.5倍行距
%        这是正文内容
%        \par  % 如果文字在大括号中，结尾需要加上 \par 行距设置才会生效
%    }
% \end{nkthesisexam}
%
% \subsection{标题名称}
%
% 本模板提供了一些命令存储模板元素的名称。
% 这些名称已经按照写作规范设置好，一般情况下不需要改动。
% 如有必要，可以使用相应命令重新定义这些名称。
%
% 只能使用 |\renewcommand*| 命令重新定义的标题名称如下：
%
%
% \begin{function}{\enabstractname}
%     英文摘要，默认值为“Abstract”。
% \end{function}
%
% \begin{function}{\prefacename}
%     序言或前言，默认值为“前言”。
% \end{function}
% \begin{function}[updated=2025/04/30]{\symabbrname}
%     符号、标志、缩略语等的注释表，默认值为“符号和缩略语说明”。
% \end{function}
%
% \begin{function}{\errataname}
%     勘误页，默认值为“勘误表”。
% \end{function}
%
% \begin{function}{\acknowledgementsname}
%     致谢，默认值为“致谢”。
% \end{function}
%
% \begin{function}{\resumename}
%     个人简历、在学期间发表的学术论文及研究成果，用于非匿名审阅论文，默认值为“个人简历、在学期间发表的学术论文及研究成果”。
% \end{function}
%
% \begin{function}{\anonymousresumename}
%     省去了个人简历的在学期间发表的学术论文及研究成果，用于匿名审阅论文，默认值为“在学期间发表的学术论文及研究成果”。
% \end{function}
%
% \begin{nkthesisexam}
%    \renewcommand*{\enabstractname}{Abstract}
% \end{nkthesisexam}
%
% 只能使用 |\ctexset| 命令重新定义的标题名称如下：
%
% \begin{function}{contentsname}
%     目录。
%     会设置 \cs{contentsname} 的值，默认值为“目录”。
% \end{function}
%
% \begin{function}{figurename}
%     图名。
%     会设置 \cs{figurename} 的值，默认值为“图”。
% \end{function}
%
% \begin{function}{tablename}
%     表名。
%     会设置 \cs{tablename} 的值，默认值为“表”。
% \end{function}
%
% \begin{function}{listfigurename}
%     图清单。
%     会设置 \cs{listfigurename} 的值，默认值为“插图清单”。
% \end{function}
%
% \begin{function}{listtablename}
%     表清单。
%     会设置 \cs{listtablename} 的值，默认值为“附表清单”。
% \end{function}
%
% \begin{function}{abstractname}
%     中文摘要。
%     会设置 \cs{abstractname} 的值，默认值为“摘要”。
% \end{function}
%
% \begin{function}{appendixname}
%     附录。
%     会设置 \cs{appendixname} 的值，默认值为“附录”。
% \end{function}
%
% \begin{function}{bibname}
%     参考文献。
%     会设置 \cs{bibname} 的值，默认值为“参考文献”。
% \end{function}
%
% \begin{nkthesisexam}
%    \ctexset{contentsname = 目录}
% \end{nkthesisexam}
%
% \section{写作实用工具}
%
% \subsection{交叉引用}
%
% 无论哪种编号模式，对小节的交叉引用可以如下进行。
% 其中，|chap:|、|sec:| 等标签前缀仅为了理解方便，不是必要格式。
% 标签内容可自定义。
%
% \subsubsection*{方式一：使用 \cs{ref} 命令引用}
%
% \begin{function}{\ref}
%     \begin{syntax}
%         \cs{ref} \marg{标签名}
%     \end{syntax}
%     使用该方式引用标签的输出结果如表~\ref{tab:ref-output} 所示。
%     \begin{table}[H]
%         \centering
%         \caption{\cs{ref}交叉引用输出结果}
%         \label{tab:ref-output}
%         \begin{tabular}{llll}
%             \toprule
%             引用对象 & 引用方式 & 输出（模式一） & 输出（模式二） \\
%             \midrule
%             chapter & |\ref{chap:a}| & 1 & 第一章 \\
%             section & |\ref{sec:a}| & 1.1 & 第一章第一节 \\
%             subsection & |\ref{subsec:a}| & 1.1.1 & 第一章第一节第一小节 \\
%             subsubsection & |\ref{subsubsec:a}| & 1.1.1.1 & 第一章第一节第一小节（一） \\
%             figure & |\ref{fig:a}| & 图1.1 & 图1.1 \\
%             subfigure & |\ref{subfig:a}| & 图1.1（a） & 图1.1（a） \\
%             table & |\ref{tab:a}| & 表1.1 & 表1.1 \\
%             equation & |\ref{eqn:a}| & 式（1.1） & 式（1.1） \\
%             \bottomrule
%         \end{tabular}
%     \end{table}
% \end{function}
%
% \subsubsection*{方式二：使用 \cs{simpleref} 命令引用}
%
% \begin{function}{\simpleref}
%     \begin{syntax}
%         \cs{simpleref} \marg{标签名}
%     \end{syntax}
%     \cs{simpleref} 命令也可以输出格式化后的引用，但是对于章、节标题仅输出当前章、节编号，方便在文中使用类似“本章第二节”这样的表达。
%     使用该方式引用标签的输出结果如表~\ref{tab:simpleref-output} 所示。
%     \begin{table}[H]
%         \centering
%         \caption{\cs{simpleref}交叉引用输出结果}
%         \label{tab:simpleref-output}
%         \begin{tabular}{llll}
%             \toprule
%             引用对象 & 引用方式 & 输出（模式一） & 输出（模式二） \\
%             \midrule
%             chapter & |\simpleref{chap:a}| & 1 & 第一章 \\
%             section & |\simpleref{sec:a}| & 1.1 & 第一节 \\
%             subsection & |\simpleref{subsec:a}| & 1.1.1 & 第一小节 \\
%             subsubsection & |\simpleref{subsubsec:a}| & 1.1.1.1 & （一） \\
%             figure & |\simpleref{fig:a}| & 图1.1 & 图1.1 \\
%             subfigure & |\simpleref{subfig:a}| & 图1.1（a） & 图1.1（a） \\
%             table & |\simpleref{tab:a}| & 表1.1 & 表1.1 \\
%             equation & |\simpleref{eqn:a}| & 式（1.1） & 式（1.1） \\
%             \bottomrule
%         \end{tabular}
%     \end{table}
% \end{function}
%
% \subsection{插入图片}
%
% 推荐使用以下方式插入单张图片：
%
% \begin{nkthesisexam}
%     \begin{figure}
%         \centering
%         \includegraphics[width=0.4\textwidth]{example-image-a}
%         \caption{这是图片的标题}
%         \label{fig:example}
%     \end{figure}
% \end{nkthesisexam}
%
% \begin{figure}[H]
%     \centering
%     \includegraphics[width=0.4\textwidth]{example-image-a}
%     \caption{这是图片的标题}
% \end{figure}
%
% 推荐使用以下方式插入含子图的图片：
%
% \begin{nkthesisexam}
%     \begin{figure}
%         \centering
%         \begin{subfigure}{0.45\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{example-image-a}
%             \caption{子图1}
%             \label{subfig:example-a}
%         \end{subfigure}
%         \quad
%         \begin{subfigure}{0.45\textwidth}
%             \centering
%             \includegraphics[width=\textwidth]{example-image-b}
%             \caption{子图2}
%             \label{subfig:example-b}
%         \end{subfigure}
%         \caption{这是图片的标题}
%         \label{fig:example}
%     \end{figure}
% \end{nkthesisexam}
%
% \begin{figure}[H]
%     \centering
%     \begin{subfigure}{0.45\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{example-image-a}
%         \caption{子图1}
%     \end{subfigure}
%     \quad
%     \begin{subfigure}{0.45\textwidth}
%         \centering
%         \includegraphics[width=\textwidth]{example-image-b}
%         \caption{子图2}
%     \end{subfigure}
%     \caption{这是图片的标题}
% \end{figure}
%
% \subsection{行内列表}
%
% 由于 \pkg{enumitem} 宏包的一个已知问题\footnote{\url{https://tex.stackexchange.com/questions/533118/enumitem-get-rid-of-extra-space-between-label-and-content-in-inline-list}}，在本模板中无法使用 |itemize*| 和 |enumerate*| 环境创建行内列表。
% 请使用以下替换环境：
%
% \noindent\DescribeEnv{inlineitemize}
% 行内无编号列表环境，类似于 |itemize*|。
%
% \begin{nkthesisexam}
%     \begin{inlineitemize}
%         \item 这是列表项1
%         \item 这是列表项2
%     \end{inlineitemize}
% \end{nkthesisexam}
%
% \noindent\DescribeEnv{inlineenumerate}
% 行内有编号列表环境，类似于 |enumerate*|。
%
% \begin{nkthesisexam}
%     \begin{inlineenumerate}
%         \item 这是列表项1
%         \item 这是列表项2
%     \end{inlineenumerate}
% \end{nkthesisexam}
%
% \end{documentation}
%
% \MaybeStop{\IndexLayout\PrintChanges\PrintIndex}
%
% \begin{implementation}
%
% \clearpage
%
% \section{代码实现}
%
%    \begin{macrocode}
%<@@=nkthesis>
%    \end{macrocode}
%
% \subsection{文档类参数定义}
%
% \subsubsection{文档类选项}
%
% \begin{variable}{\c_@@_uppercasehead_bool}
%    \begin{macrocode}
\bool_new:N \c_@@_uppercasehead_bool
%    \end{macrocode}
% \end{variable}
%
% \begin{variable}{\c_@@_headingmode_int}
%    \begin{macrocode}
\int_new:N \c_@@_headingmode_int
%    \end{macrocode}
% \end{variable}
%
% \begin{variable}{\c_@@_openright_bool}
%    \begin{macrocode}
\bool_new:N \c_@@_openright_bool
%    \end{macrocode}
% \end{variable}
%
% 定义文档类选项。
%
%    \begin{macrocode}
\keys_define:nn { nkthesis / options } {
%    \end{macrocode}
%
% \begin{macro}{headingmode}
%     可填1或者2，表示使用模式一或者模式二标题，默认为2。
%    \begin{macrocode}
    headingmode .int_set:N = \c_@@_headingmode_int,
    headingmode .initial:n = 2,
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{uppercasehead}
%     若存在 |uppercasehead| 选项，将章节页眉转换为大写。
%    \begin{macrocode}
    uppercasehead .code:n = \bool_set_true:N \c_@@_uppercasehead_bool,
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{openright}
%
% \changes{v2.2}{2025/05/23}{添加使章节必须从奇数页开始的选项。}
%
%     若存在 |openright| 选项，章节必须从奇数页开始。
%    \begin{macrocode}
    openright .code:n = \bool_set_true:N \c_@@_openright_bool,
}
%    \end{macrocode}
% \end{macro}
%
% 处理文档类选项。
%
%    \begin{macrocode}
\ProcessKeyOptions [ nkthesis / options ]
%    \end{macrocode}
%
% \subsection{载入基础类和包}
%
% 启用 \pkg{xeCJK} 宏包的自动伪粗体和伪斜体功能。
%
%    \begin{macrocode}
\PassOptionsToPackage { AutoFakeBold = true, AutoFakeSlant = true } { xeCJK }
%    \end{macrocode}
%
% \begin{variable}{\c_@@_linespread_fp}
%     固定20磅行间距（20bp / 12bp / 1.2）。
%    \begin{macrocode}
\fp_new:N \c_@@_linespread_fp
\fp_set:Nn \c_@@_linespread_fp { 20 / 12 / 1.2 }
%    \end{macrocode}
% \end{variable}
%
% 载入 \cls{ctexbook} 文档类。
% 双面打印时允许章节开始于偶数页。
% 默认字号小四，支持宋体、仿宋、楷体、黑体四种字体。
%
% \changes{v2.1}{2025/05/01}{将字体的定义从 ctex-fontset-nkthesis.def 移到 nkthesis.dtx 中。}
%
%    \begin{macrocode}
\PassOptionsToClass {
    zihao      = -4,
    linespread = \c_@@_linespread_fp,
    fontset    = none,
    UTF8,
} { ctexbook }
\bool_if:NF \c_@@_openright_bool
    { \PassOptionsToClass { openany } { ctexbook } }
\LoadClass { ctexbook }
%    \end{macrocode}
%
% 载入宏包。
%
%    \begin{macrocode}
\RequirePackage [ a4paper ] { geometry }
\RequirePackage [ titles ] { tocloft }
\RequirePackage { caption }
\RequirePackage { etoolbox }
\RequirePackage { fancyhdr }
\RequirePackage { fontspec }
\RequirePackage [ inline, shortlabels ] { enumitem }
\RequirePackage [ hidelinks ] { hyperref }
\RequirePackage { amsmath, amsthm, amssymb }
\RequirePackage { setspace }
\RequirePackage [
    backend = biber,
    style = gb7714-2015,
    url = false,
    gbpub = true,
] { biblatex }
\RequirePackage { subcaption }
\RequirePackage { tikz }
\RequirePackage { array }
\RequirePackage { newunicodechar }
%    \end{macrocode}
%
% \subsection{页面尺寸设置}
%
%    \begin{macrocode}
\dim_set:Nn \oddsidemargin  { \dim_eval:n { 32mm - 1in }   }
\dim_set:Nn \evensidemargin { \oddsidemargin               }
\dim_set:Nn \topmargin      { \dim_eval:n { 30mm - 1in }   }
\dim_set:Nn \headheight     { 14.8bp                       }
\dim_set:Nn \headsep        { \dim_eval:n { 8mm - 14.8bp } }
\dim_set:Nn \textheight     { 221mm                        }
\dim_set:Nn \textwidth      { 146mm                        }
\dim_set:Nn \footskip       { 8mm                          }
\dim_set:Nn \topskip        { 0pt                          }
%    \end{macrocode}
%
% \subsubsection{论文基本信息}
%
% \begin{variable}{\g_@@_lunwenleibie_tl}
%    \begin{macrocode}
\tl_new:N \g_@@_lunwenleibie_tl
%    \end{macrocode}
% \end{variable}
%
% \begin{variable}{\g_@@_lunwenleibiealt_tl}
%    \begin{macrocode}
\tl_new:N \g_@@_lunwenleibiealt_tl
%    \end{macrocode}
% \end{variable}
%
% \begin{variable}{\g_@@_shenqingmiji_tl}
%    \begin{macrocode}
\tl_new:N \g_@@_shenqingmiji_tl
%    \end{macrocode}
% \end{variable}
%
% \begin{variable}{\g_@@_info_prop}
%     定义论文基本信息选项。
%    \begin{macrocode}
\prop_new:N \g_@@_info_prop
%    \end{macrocode}
% \end{variable}
%
% \begin{macro}{\@@_register_info_keys:n}
%     注册论文基本信息选项。
%    \begin{macrocode}
\cs_new:Nn \@@_register_info_keys:n {
    \clist_map_inline:nn {#1} {
        \keys_define:nn { nkthesis / info } {
            ##1 .code:n = \prop_put:Nnn \g_@@_info_prop {##1} {####1},
        }
    }
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\@@_get_info:n}
%     获取论文基本信息。
%    \begin{macrocode}
\cs_new:Nn \@@_get_info:n {
    \prop_if_in:NnTF \g_@@_info_prop {#1}
        { \prop_item:Nn \g_@@_info_prop {#1} }
        { }
}
%    \end{macrocode}
% \end{macro}
%
% 定义论文基本信息快捷指令。
%
% \begin{macro}{\nktset}
%    \begin{macrocode}
\NewDocumentCommand \nktset { m } {
    \keys_set:nn { nkthesis / info } {#1}
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\nktget}
%    \begin{macrocode}
\NewExpandableDocumentCommand \nktget { m } {
    \@@_get_info:n {#1}
}
%    \end{macrocode}
% \end{macro}
%
% 注册论文基本信息选项。
%
%    \begin{macrocode}
\@@_register_info_keys:n {
    中图分类号,
    学校代码,
    UDC,
    题名页/密级,
    题名页/论文题目字号,
    论文题目（中文）,
    论文副标题,
    论文题目（英文）,
    论文作者,
    指导教师,
    指导教师职称,
    申请学位,
    培养单位,
    一级学科,
    二级学科,
    研究方向,
    答辩委员会主席,
    评阅人,
    论文完成时间,
    论文编号,
    非公开论文/保密期限/起始日期,
    非公开论文/保密期限/结束日期,
    非公开论文/审批表编号,
    非公开论文/批准日期,
    授权书/签字日期,
    学号,
    答辩日期,
    联系电话,
    电子邮箱,
    通讯地址,
    作者信息/备注,
}
%    \end{macrocode}
%
% \changes{v2.1}{2025/05/09}{去掉论文题目的默认值。}
%
% 设置默认值。
%
%    \begin{macrocode}
\nktset{
    学校代码                     = 10055,
    题名页/密级                  = 公开,
    题名页/论文题目字号          = 2,
    论文完成时间                 = { \ctexset { today = big } \today },
    非公开论文/保密期限/起始日期 = 20 \qquad 年 \qquad 月 \qquad 日,
    非公开论文/保密期限/结束日期 = 20 \qquad 年 \qquad 月 \qquad 日,
    非公开论文/批准日期          = 20 \qquad 年 \qquad 月 \qquad 日,
    授权书/签字日期              = 20 \qquad 年 \qquad 月 \qquad 日,
    答辩日期                     = 20 \qquad 年 \qquad 月 \qquad 日,
}
%    \end{macrocode}
%
% 选项设置。
%
%    \begin{macrocode}
\keys_define:nn { nkthesis / info } {
    题名页/论文类别 .tl_set:N       = \g_@@_lunwenleibie_tl,
    题名页/论文类别 .initial:n      = 硕士,
    题名页/论文类别 .choices:nn     =
        { 硕士, 博士, 硕士专业, 博士专业 }
        { \tl_set:Nn \g_@@_lunwenleibie_tl {#1} },
    作者信息/论文类别 .tl_set:N     = \g_@@_lunwenleibiealt_tl,
    作者信息/论文类别 .initial:n    = 学历硕士,
    作者信息/论文类别 .choices:nn   =
        { 博士, 学历硕士, 专业学位硕士, 同等学力硕士 }
        { \tl_set:Nn \g_@@_lunwenleibiealt_tl {#1} },
    非公开论文/申请密级 .tl_set:N   = \g_@@_shenqingmiji_tl,
    非公开论文/申请密级 .initial:n  = 公开,
    非公开论文/申请密级 .choices:nn =
        { 公开, 限制, 秘密, 机密 }
        { \tl_set:Nn \g_@@_shenqingmiji_tl {#1} },
}
%    \end{macrocode}
%
% \subsection{通用设置}
%
% 允许三级标题（subsubsection）编号。
%
%    \begin{macrocode}
\int_gset:Nn \c@secnumdepth { 3 }
%    \end{macrocode}
%
% 允许页面底部不齐。
%
%    \begin{macrocode}
\raggedbottom
%    \end{macrocode}
%
% \subsection{字体设置}
%
% \changes{v2.1}{2025/05/01}{将字体的定义从 ctex-fontset-nkthesis.def 移到 nkthesis.dtx 中。}
%
%    \begin{macrocode}
\fontspec_font_if_exist:nTF { SimSun }
    {
        \setCJKmainfont { SimSun   } [ BoldFont = SimHei, ItalicFont = KaiTi ]
        \setCJKsansfont { SimHei   }
        \setCJKmonofont { FangSong }
        \setCJKfamilyfont { zhsong } { SimSun   }
        \setCJKfamilyfont { zhhei  } { SimHei   }
        \setCJKfamilyfont { zhfs   } { FangSong }
        \setCJKfamilyfont { zhkai  } { KaiTi    }
    }
    {
        \setCJKmainfont { simsun.ttc  }
            [
                Path = fonts/,
                BoldFont = simhei.ttf,
                ItalicFont = simkai.ttf,
            ]
        \setCJKsansfont { simhei.ttf  } [ Path = fonts/ ]
        \setCJKmonofont { simfang.ttf } [ Path = fonts/ ]
        \setCJKfamilyfont { zhsong } [ Path = fonts/ ] { simsun.ttc  }
        \setCJKfamilyfont { zhhei  } [ Path = fonts/ ] { simhei.ttf  }
        \setCJKfamilyfont { zhfs   } [ Path = fonts/ ] { simfang.ttf }
        \setCJKfamilyfont { zhkai  } [ Path = fonts/ ] { simkai.ttf  }
    }
%    \end{macrocode}
%
% \begin{macro}{\songti}
%    \begin{macrocode}
\NewDocumentCommand \songti   { } { \CJKfamily { zhsong } }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\heiti}
%    \begin{macrocode}
\NewDocumentCommand \heiti    { } { \CJKfamily { zhhei  } }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\fangsong}
%    \begin{macrocode}
\NewDocumentCommand \fangsong { } { \CJKfamily { zhfs   } }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\kaishu}
%    \begin{macrocode}
\NewDocumentCommand \kaishu   { } { \CJKfamily { zhkai  } }
%    \end{macrocode}
% \end{macro}
%
% 将默认英文字体设置为 Times New Roman。
%
%    \begin{macrocode}
\fontspec_font_if_exist:nTF { Times~New~Roman }
    {
        \setmainfont { Times~New~Roman }
    }
    {
        \setmainfont { times }
            [
                Path = fonts/,
                ItalicFont = *i,
                BoldFont = *bd,
                BoldItalicFont = *bi,
            ]
    }
%    \end{macrocode}
%
% \begin{macro}{\arial}
%    \begin{macrocode}
\fontspec_font_if_exist:nTF { Arial }
    {
        \newfontfamily { \arial } { Arial }
    }
    {
        \newfontfamily { \arial } { arial }
            [
                Path = fonts/,
                ItalicFont = *i,
                BoldFont = *bd,
                BoldItalicFont = *bi,
            ]
    }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\dejavusans}
%
% \changes{v2.1}{2025/05/01}
%     {将 Segoe UI Symbol替换为 DejaVu Sans。\cs{segoeui} 命令不再可用。}
%
%    \begin{macrocode}
\newfontfamily { \dejavusans } { DejaVu Sans }
%    \end{macrocode}
% \end{macro}
%
% \changes{v2.1}{2025/05/01}{
%     定义★符号字体。
%     此前，在文中插入★需要使用 \texttt{\{\textbackslash segoeui ★\}} 语句，现在直接键入★即可。
% }
%
% 定义★符号字体。
%
%    \begin{macrocode}
\newunicodechar { ★ } { { \dejavusans ★ } }
%    \end{macrocode}
%
% \subsection{私有命令定义}
%
% \begin{variable}{\c_@@_msbaselinespread_fp}
%     Microsoft Word 基础行距（中易字库）。
%    \begin{macrocode}
\fp_new:N \c_@@_msbaselinespread_fp
\fp_set:Nn \c_@@_msbaselinespread_fp { 1.296875 }
%    \end{macrocode}
% \end{variable}
%
% \begin{macro}{\@@_ifcheckbox:nn}
%     根据选项为复选框打勾。
%    \begin{macrocode}
\cs_new:Nn \@@_ifcheckbox:nn {
    \str_if_eq:eeTF {#1} {#2}
        {
            \makebox [ 0pt ] [ l ] { $\square$ }
            \raisebox { 0.15ex } { \hspace { 0.1em } $\checkmark$ }
        }
        { $\square$ }
}
%    \end{macrocode}
% \end{macro}
%
% \makeatletter
% \let\@oldxobeysp\@xobeysp
% \renewcommand*{\@xobeysp}{\leavevmode\penalty100\ }
% \makeatother
% \begin{macro}{\@@_nankai_logo:n}
%     南开大学 Logo。
%    \begin{macrocode}
\cs_new:Nn \@@_nankai_logo:n {
    \scalebox { \fp_eval:n { #1 * 0.0525 } } {
        \begin { tikzpicture } [ y = 1cm, x = 1cm, inner~sep = 0pt, outer~sep = 0pt ]
%    \end{macrocode}
%
% 具体绘图代码省略。
%
% \iffalse
%    \begin{macrocode}
            \path[fill=black,even~odd~rule,cm={1.0,-0.0,-0.0,-1.0,(41.5396, 20.8756)}] (2.095, 24.2872).. controls (2.3492, 24.3592) and (1.9213, 25.2117) .. (1.7639, 25.5968).. controls (1.7435, 25.6462) and (1.6036, 25.9376) .. (1.5698, 25.9981).. controls (1.497, 26.1307) and (1.4419, 26.2746) .. (1.4039, 26.4199).. controls (1.3234, 26.7218) and (1.3185, 27.0384) .. (1.3382, 27.3474).. controls (1.3806, 28.0012) and (1.6023, 28.5393) .. (1.5861, 29.191).. controls (1.3495, 29.2292) and (1.1865, 29.4611) .. (0.9499, 29.4534).. controls (0.3682, 28.9047) and (-0.6851, 27.6534) .. (0.6534, 27.2218).. controls (0.7332, 27.1958) and (0.8073, 26.556) .. (0.8292, 26.4615).. controls (0.8977, 26.1674) and (0.9704, 25.8712) .. (1.0769, 25.5855).. controls (1.1928, 25.2739) and (1.3467, 24.9064) .. (1.5951, 24.6645).. controls (1.7152, 24.5482) and (1.9433, 24.3337) .. (2.095, 24.2872)(10.9968, 24.6151).. controls (11.0321, 23.7935) and (11.1132, 22.9746) .. (11.1274, 22.1502) -- (11.1282, 22.086) -- (11.1288, 22.086) -- (11.1288, 22.0232) -- (11.1295, 21.9597) -- (11.1295, 21.8257).. controls (11.1324, 21.5705) and (11.1486, 21.3223) .. (11.1803, 21.0718) -- (11.1832, 21.055) -- (11.1875, 21.0211) -- (11.1903, 21.0041) -- (11.1924, 20.9865) -- (11.1953, 20.9696) -- (11.1973, 20.9526) -- (11.2001, 20.935) -- (11.203, 20.9181) -- (11.2051, 20.9011) -- (11.2086, 20.8835) -- (11.2115, 20.8665) -- (11.2136, 20.8497) -- (11.2163, 20.8321) -- (11.2192, 20.8151) -- (11.2228, 20.7975).. controls (11.2594, 20.5901) and (11.3505, 20.2763) .. (11.1169, 20.1402).. controls (10.7717, 19.9392) and (10.1179, 20.3574) .. (9.8362, 20.5027).. controls (8.1291, 21.3856) and (6.47, 22.3596) .. (4.7452, 23.211).. controls (4.405, 23.3787) and (4.0598, 23.5446) .. (3.6977, 23.6686).. controls (3.3806, 23.7766) and (3.0566, 23.8005) .. (2.7382, 23.9147).. controls (2.4113, 24.0312) and (2.1734, 24.0643) .. (1.8147, 24.0495).. controls (1.6778, 23.4091) and (2.8038, 22.8844) .. (3.279, 22.6284).. controls (3.6306, 22.4394) and (3.9997, 22.2785) .. (4.3684, 22.1219).. controls (4.6005, 22.0239) and (5.2769, 21.866) .. (5.416, 21.6685).. controls (5.8607, 21.0337) and (6.1439, 20.2467) .. (6.2222, 19.2685).. controls (5.1492, 19.5675) and (2.4247, 20.7897) .. (2.2222, 20.9075).. controls (1.886, 21.1007) and (1.5981, 21.246) .. (1.1307, 21.055).. controls (0.5934, 20.8356) and (1.2493, 20.0449) .. (1.5924, 19.7889).. controls (1.6023, 19.9251) and (1.543, 20.2143) .. (1.6884, 20.2904).. controls (1.771, 20.3328) and (2.0492, 20.2319) .. (2.1353, 20.2065).. controls (2.7537, 20.0216) and (3.363, 19.717) .. (3.9454, 19.4504).. controls (4.6422, 19.1317) and (5.3193, 18.7734) .. (6.0041, 18.432).. controls (6.2152, 18.3269) and (6.4919, 18.3234) .. (6.6035, 18.1083).. controls (6.7171, 17.8876) and (6.6931, 17.4877) .. (6.7277, 17.2415).. controls (6.8075, 16.6667) and (6.8873, 16.0926) .. (7.0736, 15.5375).. controls (7.1385, 15.3422) and (7.2649, 15.1504) .. (7.3122, 14.9536) -- (7.3165, 14.9324) -- (7.3193, 14.9211) -- (7.3215, 14.9105) -- (7.3229, 14.9) -- (7.325, 14.8887) -- (7.3264, 14.8774) -- (7.3278, 14.8668) -- (7.3335, 14.8216) -- (7.3342, 14.8104) -- (7.3355, 14.7991) -- (7.3363, 14.7879) -- (7.337, 14.7759) -- (7.337, 14.7646) -- (7.3377, 14.7533) -- (7.3377, 14.7413) -- (7.3385, 14.73) -- (7.3385, 14.6243) -- (7.3377, 14.6122) -- (7.3377, 14.5882) -- (7.337, 14.5769).. controls (7.3349, 14.5134) and (7.3306, 14.4508) .. (7.3271, 14.3886) -- (7.3271, 14.3774) -- (7.3264, 14.3774) -- (7.3264, 14.3661) -- (7.3257, 14.3541) -- (7.3257, 14.3429) -- (7.3242, 14.3203) -- (7.3242, 14.2977) -- (7.3235, 14.2977) -- (7.3235, 14.2638) -- (7.3229, 14.2533) -- (7.3229, 14.2201) -- (7.3222, 13.0373) -- (7.3222, 12.6756) -- (7.3222, 10.9046).. controls (7.7803, 10.796) and (9.529, 12.5895) .. (9.5941, 12.6869).. controls (10.2633, 13.694) and (9.1513, 16.637) .. (8.8612, 17.4179).. controls (9.8955, 17.4707) and (10.7547, 16.7661) .. (11.6456, 16.458).. controls (11.8547, 16.386) and (11.0632, 15.8796) .. (11.018, 15.8591).. controls (10.8754, 15.795) and (10.7201, 15.7428) .. (10.5952, 15.6504) -- (10.5902, 15.6469) -- (10.5775, 15.6362) -- (10.5725, 15.6327).. controls (10.4899, 15.5601) and (10.4165, 15.4381) .. (10.4144, 15.3415) -- (10.4144, 15.3365).. controls (10.8168, 15.3196) and (11.2468, 15.4346) .. (11.659, 15.4361).. controls (11.904, 15.4374) and (12.1497, 15.4311) .. (12.3954, 15.4283).. controls (12.5684, 15.4261) and (12.7893, 15.3577) .. (12.958, 15.405).. controls (13.1388, 15.4557) and (13.1578, 15.5897) .. (13.2997, 15.6842).. controls (13.4191, 15.7647) and (13.6287, 15.7434) .. (13.6952, 15.8302).. controls (13.9711, 16.2019) and (13.5814, 16.5306) .. (13.2511, 16.6385).. controls (12.7074, 16.8162) and (12.1914, 17.0384) .. (11.6555, 17.2352).. controls (11.1204, 17.4312) and (10.5965, 17.6519) .. (10.0621, 17.8494).. controls (9.7754, 17.9552) and (9.4902, 18.0653) .. (9.2008, 18.1647).. controls (9.0299, 18.2225) and (8.4503, 18.3128) .. (8.3479, 18.4461).. controls (8.0662, 18.8156) and (7.8482, 19.224) .. (7.6462, 19.6352).. controls (7.4562, 20.0223) and (7.1492, 20.4794) .. (7.0602, 20.892).. controls (7.558, 20.9096) and (8.1905, 20.5753) .. (8.6403, 20.4131).. controls (9.4133, 20.1338) and (10.1799, 19.8333) .. (10.958, 19.5661).. controls (11.2199, 19.4765) and (11.496, 19.3362) .. (11.7713, 19.2938).. controls (12.0014, 19.2586) and (11.9343, 19.2621) .. (12.0841, 19.4158).. controls (12.2288, 19.5632) and (12.4328, 19.5999) .. (12.5098, 19.8051).. controls (12.6178, 20.0894) and (12.466, 20.5111) .. (12.4533, 20.806).. controls (12.4102, 21.8166) and (12.2986, 22.8272) .. (12.2125, 23.8344).. controls (12.0855, 25.35) and (11.9563, 26.8657) .. (11.8151, 28.3799).. controls (11.7946, 28.5978) and (11.748, 28.8101) .. (11.7381, 29.0295).. controls (11.7283, 29.2418) and (11.8257, 29.7594) .. (11.6174, 29.911).. controls (11.1402, 30.2567) and (9.8778, 29.1303) .. (9.546, 28.8665).. controls (9.2926, 28.667) and (9.0561, 28.4489) .. (8.775, 28.2825).. controls (8.6896, 28.2325) and (8.5675, 28.0597) .. (8.4567, 28.0964).. controls (8.2795, 28.1562) and (8.3274, 28.2727) .. (8.23, 28.3608).. controls (8.0105, 28.5598) and (7.1612, 28.4765) .. (6.9071, 28.4052).. controls (6.5674, 28.3108) and (6.547, 27.9935) .. (6.5894, 27.7021).. controls (6.6, 27.628) and (5.9491, 27.6238) .. (5.87, 27.5075).. controls (5.8487, 27.4779) and (5.8424, 27.3318) .. (5.8219, 27.2789).. controls (5.714, 27.0074) and (5.9349, 26.9432) .. (6.1411, 26.8149).. controls (6.393, 26.659) and (6.6493, 26.5489) .. (6.9557, 26.5363).. controls (7.0504, 26.5321) and (6.8724, 26.1992) .. (6.8421, 26.1688).. controls (6.7397, 26.0652) and (6.5809, 26.0278) .. (6.4475, 25.9721).. controls (6.2039, 25.8698) and (5.896, 25.8056) .. (6.0359, 25.5038).. controls (6.1664, 25.2217) and (6.6606, 24.924) .. (6.9557, 24.8225).. controls (6.9918, 24.8098) and (7.1485, 24.3302) .. (7.1888, 24.2611).. controls (7.2925, 24.0848) and (7.4211, 23.9232) .. (7.5418, 23.7575).. controls (7.7698, 23.4437) and (8.1008, 22.9944) .. (8.0352, 22.5931).. controls (8.0274, 22.5431) and (7.93, 22.3689) .. (7.2494, 22.9028).. controls (7.0207, 23.0812) and (6.8223, 23.4056) .. (6.6388, 23.627).. controls (6.427, 23.881) and (6.1912, 24.12) .. (5.9879, 24.3803).. controls (5.7888, 24.6335) and (5.7012, 24.8627) .. (5.3285, 24.8379).. controls (5.0158, 24.8176) and (4.7071, 24.6928) .. (4.4432, 24.5439).. controls (4.05, 24.3225) and (3.8705, 24.2512) .. (4.0337, 23.8005).. controls (4.0217, 23.8351) and (5.2967, 23.7533) .. (5.4259, 23.7088).. controls (5.8367, 23.5672) and (6.1736, 23.2856) .. (6.5159, 23.0396).. controls (6.8266, 22.8167) and (7.1252, 22.5762) .. (7.3976, 22.3138).. controls (7.6645, 22.0571) and (7.8064, 22.0006) .. (8.1581, 21.8766).. controls (8.432, 21.7799) and (8.6452, 21.5761) .. (8.9234, 21.4873).. controls (9.3525, 21.3518) and (9.9914, 21.7383) .. (9.7268, 22.1961).. controls (9.6322, 22.359) and (9.3878, 22.476) .. (9.2614, 22.6256).. controls (9.1232, 22.7891) and (9.0186, 22.9733) .. (8.8528, 23.1171).. controls (8.3755, 23.5304) and (7.8425, 23.9924) .. (7.5551, 24.5467).. controls (7.8304, 24.6257) and (8.2936, 24.381) .. (8.4771, 24.601).. controls (8.6183, 24.771) and (8.5477, 25.0531) .. (8.5224, 25.2463).. controls (8.4948, 25.4537) and (8.2343, 25.5546) .. (8.2067, 25.7182).. controls (8.1701, 25.9319) and (8.4461, 25.8811) .. (8.571, 25.9276).. controls (8.7066, 25.9791) and (8.6741, 25.8917) .. (8.7299, 26.0433).. controls (8.7765, 26.1738) and (8.6458, 26.4672) .. (8.6205, 26.6026).. controls (8.5837, 26.8057) and (8.5329, 27.001) .. (8.5859, 27.2126).. controls (8.7532, 27.8748) and (8.9234, 27.8354) .. (9.347, 28.0251).. controls (9.8306, 28.2417) and (11.0003, 28.7156) .. (10.804, 27.975).. controls (10.6347, 27.3346) and (11.0293, 26.5602) .. (10.9961, 25.9474) -- (10.9926, 25.8832) -- (10.9898, 25.8197) -- (10.9835, 25.6293) -- (10.982, 25.5659) -- (10.9813, 25.5016) -- (10.9806, 25.4389) -- (10.9806, 25.2485) -- (10.982, 25.1216) -- (10.9827, 25.0588) -- (10.9835, 25.0588) -- (10.9876, 24.8683) -- (10.9898, 24.8055) -- (10.9918, 24.7421) -- (10.9947, 24.6786) -- (10.9975, 24.6158) -- cycle;
            \path[fill=black,even~odd~rule,cm={1.0,-0.0,-0.0,-1.0,(61.2246, 22.1456)}] (0.8278, 24.3309).. controls (1.3109, 24.2464) and (1.197, 24.9629) .. (1.2315, 25.2304).. controls (1.279, 25.5951) and (1.3399, 25.9584) .. (1.3978, 26.3222).. controls (1.4777, 26.8326) and (1.7076, 27.3696) .. (1.728, 27.8828).. controls (1.7493, 28.3932) and (0.0447, 28.8437) .. (0.0287, 28.7036).. controls (-0.0606, 27.9575) and (0.134, 27.1036) .. (0.262, 26.366).. controls (0.3284, 25.9885) and (0.4083, 25.612) .. (0.5116, 25.2411).. controls (0.5407, 25.1348) and (0.7139, 24.3514) .. (0.8278, 24.3309)(4.9575, 26.789) -- (4.9449, 26.8002).. controls (4.8811, 26.8642) and (4.8656, 27.0234) .. (4.8437, 27.0994).. controls (4.7921, 27.2831) and (4.6704, 27.5365) .. (4.6889, 27.7294).. controls (4.72, 28.0455) and (5.1437, 28.0032) .. (5.4244, 28.132).. controls (5.5071, 27.7286) and (5.7476, 27.0213) .. (5.3374, 26.7024).. controls (5.2795, 26.8298) and (5.0489, 26.7235) .. (4.9583, 26.7882) -- (4.9583, 26.789) -- cycle(10.1647, 27.7231).. controls (10.1647, 27.9765) and (10.1491, 28.2299) .. (10.1421, 28.4832) -- (10.1421, 28.4967) -- (10.1413, 28.5093) -- (10.1413, 28.5354) -- (10.1406, 28.5481).. controls (10.1321, 28.9113) and (10.2573, 29.1415) .. (9.9794, 29.4266).. controls (9.8662, 29.5413) and (9.4652, 30.0129) .. (9.2741, 29.9736).. controls (9.086, 29.934) and (6.612, 29.1393) .. (5.6422, 28.6853).. controls (5.189, 28.4727) and (4.7185, 28.3158) .. (4.2573, 28.1257).. controls (4.007, 28.0209) and (3.6887, 27.7752) .. (3.7531, 27.4872).. controls (3.5551, 27.5034) and (3.0232, 27.4633) .. (3.0493, 27.1796).. controls (3.0656, 27.01) and (3.3861, 26.9037) .. (3.5146, 26.8383).. controls (3.7008, 26.7432) and (3.8471, 26.6742) .. (3.9193, 26.4771).. controls (4.1046, 25.9689) and (3.3698, 26.1111) .. (3.0394, 26.1041).. controls (3.0493, 25.7197) and (3.263, 25.5676) .. (3.5954, 25.3924).. controls (3.9249, 25.2178) and (4.195, 25.0193) .. (4.5509, 24.8806).. controls (5.0113, 24.7011) and (5.3713, 24.4026) .. (5.7908, 24.1577).. controls (6.2576, 23.8853) and (6.4338, 24.1907) .. (6.9146, 24.202).. controls (7.0843, 24.7806) and (6.5942, 24.8222) .. (6.2646, 25.1531).. controls (6.4033, 25.3171) and (6.7223, 25.1847) .. (6.9161, 25.2256).. controls (7.0257, 26.2976) and (7.3553, 27.7871) .. (6.1996, 28.4368).. controls (6.2929, 28.3841) and (6.7972, 28.5649) .. (6.9161, 28.5889).. controls (7.1863, 28.6438) and (7.4572, 28.6945) .. (7.7302, 28.7353).. controls (8.2219, 28.8106) and (8.7684, 28.8965) .. (9.2642, 28.8409).. controls (9.4659, 28.0046) and (8.9291, 27.1001) .. (8.9757, 26.2477).. controls (8.4345, 24.3253) and (9.2545, 21.1385) .. (8.9905, 18.8044).. controls (8.6801, 18.76) and (8.8753, 19.8258) .. (8.8653, 19.9567).. controls (8.8441, 20.2334) and (8.6363, 20.3277) .. (8.4311, 20.5065).. controls (8.1511, 20.7501) and (8.0046, 21.0323) .. (7.8524, 21.3533).. controls (7.7677, 21.5321) and (7.6786, 21.7081) .. (7.5782, 21.8805).. controls (7.5088, 21.9981) and (7.2994, 22.2155) .. (7.2873, 22.3473).. controls (7.2542, 22.7316) and (7.6531, 23.2285) .. (6.9648, 23.1821).. controls (6.7025, 23.1644) and (6.4146, 23.0899) .. (6.1975, 22.947).. controls (6.1252, 22.8998) and (5.7857, 22.4795) .. (5.7462, 22.4837).. controls (5.0899, 22.5471) and (5.0863, 23.2348) .. (5.0792, 23.7058).. controls (5.0792, 23.9831) and (4.7356, 24.454) .. (4.3669, 24.535) -- (4.3465, 24.5392) -- (4.326, 24.542) -- (4.3252, 24.542) -- (4.3048, 24.5449) -- (4.2842, 24.5462) -- (4.2418, 24.5462) -- (4.2214, 24.5449) -- (4.2001, 24.5427) -- (4.1795, 24.5392) -- (4.1591, 24.535) -- (4.1386, 24.5294).. controls (4.1174, 24.2598) and (4.2779, 24.0275) .. (4.3431, 23.7733).. controls (4.3846, 23.6101) and (4.3698, 23.3616) .. (4.3324, 23.2039).. controls (4.0198, 23.3433) and (3.6711, 23.9648) .. (3.3557, 23.9669).. controls (3.1746, 23.9683) and (2.8477, 23.6382) .. (2.7848, 23.496).. controls (2.485, 22.8189) and (4.3465, 22.6485) .. (4.7185, 22.4837).. controls (4.7434, 22.4732) and (4.8557, 21.5814) .. (4.8855, 21.4729).. controls (4.9725, 21.1633) and (5.1252, 20.7838) .. (5.0681, 20.465).. controls (5.0906, 20.3488) and (4.2708, 20.8204) .. (4.1831, 20.8732).. controls (3.8953, 21.0457) and (3.6195, 21.2343) .. (3.3258, 21.3969).. controls (2.7791, 21.6988) and (1.9622, 22.0094) .. (1.3144, 21.8439).. controls (1.1963, 21.8143) and (1.1057, 21.7173) .. (1.013, 21.6511).. controls (1.3066, 21.1603) and (2.137, 20.7782) .. (2.6511, 20.5198).. controls (3.2941, 20.1974) and (3.9702, 19.9356) .. (4.6443, 19.6779).. controls (4.7368, 19.6428) and (4.6726, 19.5273) .. (4.7356, 19.4865).. controls (4.8203, 19.4309) and (5.0531, 19.4696) .. (5.1556, 19.4696).. controls (5.382, 19.4696) and (5.7101, 19.3879) .. (5.9111, 19.5224).. controls (6.1734, 19.6977) and (6.0313, 20.0602) .. (5.9534, 20.2946).. controls (5.7483, 20.9063) and (5.3898, 21.4019) .. (5.4533, 22.0726).. controls (7.2528, 22.4501) and (7.3001, 21.1949) .. (8.0223, 20.5677).. controls (8.1518, 19.4794) and (8.4256, 18.5249) .. (8.7565, 17.6254).. controls (8.9828, 17.6119) and (9.1744, 17.5936) .. (9.3988, 17.5923).. controls (9.5769, 17.5923) and (9.8881, 17.5091) .. (10.0571, 17.5535) -- (10.0571, 17.5542) -- (10.0585, 17.5542) -- (10.0592, 17.5549) -- (10.06, 17.5549) -- (10.0614, 17.5557) -- (10.0641, 17.5557) -- (10.0648, 17.5563) -- (10.0685, 17.557) -- (10.0705, 17.5577) -- (10.0705, 17.5585) -- (10.0733, 17.5585).. controls (10.4243, 17.688) and (10.2651, 18.6305) .. (10.2905, 18.9227).. controls (10.4949, 21.2505) and (9.7084, 23.5502) .. (9.9305, 26.3145) -- (9.9532, 26.354) -- (9.9743, 26.3934) -- (9.9843, 26.4137) -- (9.985, 26.4137).. controls (10.1816, 26.8115) and (10.1695, 27.2979) .. (10.1654, 27.7223) -- cycle(4.7179, 25.631) -- (4.7179, 26.1104).. controls (4.9852, 25.8569) and (5.536, 25.7571) .. (5.626, 25.3382).. controls (5.1677, 25.2537) and (5.2943, 25.4339) .. (4.7179, 25.631);
            \path[fill=black,even~odd~rule,cm={1.0,-0.0,-0.0,-1.0,(77.5758, 22.9923)}] (2.0248, 26.2024).. controls (1.6123, 26.0469) and (1.3882, 25.8226) .. (1.346, 25.1073).. controls (1.6087, 25.1128) and (1.5995, 25.3724) .. (1.7853, 25.4497).. controls (2.4176, 25.2641) and (3.1918, 25.2114) .. (3.5457, 24.7661).. controls (3.5676, 24.7373) and (4.1349, 24.6986) .. (4.2217, 24.6698).. controls (4.4062, 24.6085) and (4.5737, 24.5164) .. (4.7368, 24.4173).. controls (4.9472, 24.2886) and (5.2285, 24.2302) .. (5.4205, 24.0846).. controls (5.7165, 23.8603) and (5.658, 23.4199) .. (5.718, 23.1014).. controls (5.874, 22.2721) and (6.2146, 21.4794) .. (6.3439, 20.6432).. controls (6.4236, 20.1318) and (6.0275, 19.0184) .. (6.8813, 18.9439).. controls (7.0517, 18.9291) and (7.1436, 19.0781) .. (7.2156, 19.1949).. controls (7.3342, 19.389) and (7.3575, 19.3307) .. (7.5412, 19.4411) -- (7.5553, 19.4503) -- (7.5695, 19.458) -- (7.5829, 19.4671) -- (7.5969, 19.4756) -- (7.6105, 19.484) -- (7.6231, 19.4924) -- (7.6365, 19.5009) -- (7.6494, 19.5093) -- (7.65, 19.5093).. controls (7.8866, 19.6668) and (8.0393, 19.8343) .. (8.0428, 20.1135) -- (8.0435, 20.129).. controls (8.0435, 20.3667) and (8.0272, 20.6087) .. (7.9926, 20.8457) -- (7.9882, 20.8738) -- (7.9863, 20.8885) -- (7.9841, 20.902) -- (7.9812, 20.9168) -- (7.98, 20.9308) -- (7.9771, 20.9448) -- (7.9749, 20.9589) -- (7.9722, 20.973) -- (7.97, 20.9871) -- (7.9671, 21.0011) -- (7.9652, 21.0159) -- (7.9623, 21.0292) -- (7.9594, 21.0434).. controls (7.9354, 21.1706) and (7.9148, 21.319) .. (7.8436, 21.4337).. controls (7.7461, 21.5906) and (7.6791, 21.6362) .. (7.6331, 21.8128).. controls (7.5821, 22.0048) and (7.5483, 22.1898) .. (7.4769, 22.3776).. controls (7.3393, 22.7377) and (7.1703, 23.0788) .. (7.1371, 23.4663).. controls (7.5461, 23.6633) and (7.989, 23.3046) .. (8.3839, 23.261).. controls (8.2794, 22.787) and (8.2794, 22.8474) .. (8.3839, 22.3726).. controls (8.4009, 22.2987) and (9.0069, 22.3916) .. (9.0733, 22.3931).. controls (9.1722, 22.3938) and (9.2896, 22.4056) .. (9.3793, 22.3565).. controls (9.452, 22.3157) and (9.4486, 22.2074) .. (9.5235, 22.17).. controls (9.6159, 22.1237) and (9.8363, 22.168) .. (9.9396, 22.1687).. controls (10.2758, 22.1715) and (10.6127, 22.1673) .. (10.9498, 22.1673).. controls (11.3417, 23.306) and (9.9359, 23.3017) .. (8.7194, 23.7097) -- (8.6665, 23.7274) -- (8.6665, 23.7279) -- (8.613, 23.7456) -- (8.5606, 23.7632) -- (8.5077, 23.7815) -- (8.4554, 23.799).. controls (7.4268, 24.1514) and (6.5508, 24.4918) .. (6.5508, 24.4918).. controls (6.1405, 26.6877) and (4.9077, 29.0285) .. (2.4147, 29.6839).. controls (1.7062, 29.8703) and (0.7696, 30.0307) .. (0.0333, 29.9582).. controls (-0.0816, 29.9463) and (0.2298, 29.7732) .. (0.2206, 29.7824).. controls (0.3562, 29.6431) and (0.323, 29.6094) .. (0.581, 29.5384).. controls (1.0408, 29.411) and (1.4815, 29.2345) .. (1.9019, 29.0165).. controls (2.6959, 28.605) and (3.3981, 28.0648) .. (4.1312, 27.569).. controls (4.1921, 27.5275) and (4.2401, 27.0745) .. (4.2754, 26.9796).. controls (4.3433, 26.7995) and (4.4329, 26.6279) .. (4.5247, 26.4555).. controls (4.6937, 26.1383) and (5.1691, 25.4667) .. (5.1555, 25.1101).. controls (4.8052, 25.3794) and (4.5092, 25.5721) .. (4.0861, 25.7276).. controls (3.7865, 25.8373) and (3.4137, 26.1187) .. (3.0936, 26.1545).. controls (2.9812, 26.1671) and (2.2163, 26.2748) .. (2.0248, 26.2024)(7.4309, 25.7909).. controls (7.3724, 25.7867) and (7.7299, 26.0104) .. (7.7609, 26.023).. controls (7.8251, 26.0505) and (7.9107, 26.056) .. (7.9601, 26.1116).. controls (8.0167, 26.1763) and (7.989, 26.286) .. (8.0527, 26.3423).. controls (8.1198, 26.4021) and (8.324, 26.4197) .. (8.4144, 26.4534).. controls (8.6397, 26.5385) and (8.8467, 26.6554) .. (9.0431, 26.7861).. controls (9.1625, 26.8649) and (10.0518, 27.6253) .. (10.1443, 27.569).. controls (10.6178, 27.2812) and (11.2152, 27.633) .. (11.7189, 27.4937).. controls (11.9005, 27.4438) and (12.1584, 27.3481) .. (12.1223, 27.6218).. controls (12.1168, 27.6667) and (11.7882, 28.1099) .. (11.7563, 28.1162).. controls (10.8762, 28.2892) and (10.523, 28.8708) .. (9.8505, 28.7998).. controls (9.2931, 28.74) and (8.0181, 27.2504) .. (8.0181, 27.1588).. controls (7.5802, 26.7468) and (7.0976, 26.3761) .. (6.7712, 25.8598).. controls (6.9543, 25.8021) and (7.164, 25.7705) .. (7.4309, 25.7909);
            \path[fill=black,even~odd~rule,cm={1.0,-0.0,-0.0,-1.0,(96.1496, 20.1348)}] (9.4857, 17.6894) -- (9.4857, 17.0734)(10.0232, 23.6511).. controls (10.2556, 23.7397) and (10.4216, 23.9038) .. (10.4026, 24.2009).. controls (10.3673, 24.7289) and (9.9286, 24.9022) .. (9.4235, 24.9197).. controls (9.0907, 24.9317) and (8.1321, 24.7206) .. (7.9202, 25.0457).. controls (7.7762, 25.2675) and (8.0883, 25.6724) .. (8.1302, 25.9061).. controls (8.1902, 26.244) and (8.2177, 26.5868) .. (8.2347, 26.9297).. controls (8.2658, 27.5669) and (8.2585, 28.2082) .. (8.2515, 28.8461).. controls (8.2452, 29.3671) and (7.8326, 29.8077) .. (7.2831, 29.9473).. controls (6.9108, 30.0422) and (6.5089, 29.8712) .. (6.1373, 29.838).. controls (5.7021, 29.7994) and (5.2923, 29.9077) .. (4.9059, 29.6762).. controls (4.6397, 29.5177) and (4.3854, 29.5135) .. (4.0958, 29.391) -- (4.0802, 29.384) -- (4.0632, 29.3768) -- (4.0468, 29.3698) -- (4.0294, 29.3628) -- (4.0124, 29.3558) -- (3.9947, 29.3487) -- (3.9579, 29.3347) -- (3.9404, 29.3269) -- (3.922, 29.3206) -- (3.9035, 29.3128).. controls (3.5806, 29.1832) and (3.2021, 29.0164) .. (3.1879, 28.6857) -- (3.1873, 28.6665).. controls (3.4895, 28.8918) and (3.9312, 28.8434) .. (4.2956, 28.8707).. controls (4.7011, 28.901) and (5.1087, 28.9172) .. (5.5135, 28.9572).. controls (5.83, 28.9883) and (6.148, 29.0277) .. (6.4656, 29.0319).. controls (6.8507, 29.0362) and (7.1601, 28.7257) .. (7.4335, 28.5032).. controls (7.4965, 28.2103) and (7.4907, 27.9231) .. (7.5721, 27.6344).. controls (7.6363, 27.4014) and (7.5317, 27.1762) .. (7.4802, 26.9502).. controls (7.4095, 26.6403) and (7.3714, 26.3242) .. (7.3028, 26.0138).. controls (7.2639, 25.8377) and (7.2209, 25.5174) .. (7.117, 25.3724).. controls (7.0076, 25.2217) and (7.0726, 25.2837) .. (6.8839, 25.3055).. controls (6.8351, 25.3112) and (6.4192, 25.3456) .. (6.4063, 25.3548).. controls (5.4789, 26.0624) and (4.2962, 26.5327) .. (3.2544, 27.1339) -- (2.0802, 27.1339).. controls (2.0033, 27.1339) and (1.696, 26.8065) .. (1.6495, 26.7474).. controls (1.239, 26.2194) and (1.7547, 26.0891) .. (2.2054, 25.9511).. controls (2.6326, 25.8201) and (3.0318, 25.597) .. (3.4345, 25.4111).. controls (4.2469, 25.0359) and (5.0119, 24.5824) .. (5.8787, 24.3171).. controls (6.4332, 24.1467) and (6.997, 24.0299) .. (7.5799, 23.9862).. controls (7.6348, 23.9777) and (7.7698, 23.7764) .. (7.8511, 23.7412).. controls (7.9668, 23.6898) and (8.1103, 23.6983) .. (8.2361, 23.682).. controls (8.5538, 23.6404) and (8.8606, 23.5659) .. (9.1841, 23.5561).. controls (9.4369, 23.5476) and (9.7697, 23.5546) .. (10.0239, 23.6511) -- cycle(9.266, 17.7576).. controls (9.2787, 17.6781) and (9.3818, 17.6838) .. (9.4857, 17.6894) -- (9.4857, 17.0734).. controls (9.2553, 17.1521) and (9.3076, 16.9663) .. (9.1926, 16.9367).. controls (9.2172, 17.198) and (8.9459, 17.6429) .. (9.266, 17.7576)(5.8201, 16.8685).. controls (6.0101, 16.8403) and (6.0319, 16.6552) .. (6.1133, 16.5256).. controls (5.998, 16.4967) and (6.0504, 16.3109) .. (5.8201, 16.389) -- cycle(6.92, 16.6628) -- (7.6533, 16.6628).. controls (7.5162, 16.3594) and (8.0778, 16.1102) .. (7.6533, 15.9786).. controls (7.3679, 16.1687) and (7.1849, 16.4538) .. (6.92, 16.6628)(5.8201, 15.3626) -- (5.8201, 15.9786).. controls (6.2708, 15.9652) and (6.4277, 15.6787) .. (6.5541, 15.3626).. controls (6.2708, 15.3006) and (6.1966, 15.2977) .. (5.8201, 15.3626)(9.3394, 15.9786).. controls (10.2069, 15.6076) and (10.652, 17.2282) .. (10.0721, 17.895).. controls (10.914, 17.6077) and (11.4085, 16.9973) .. (11.6855, 16.1835) -- (11.9058, 16.1835).. controls (12.064, 15.3506) and (12.7006, 14.9641) .. (12.6391, 13.925).. controls (11.3373, 13.5708) and (10.337, 14.4522) .. (9.3394, 14.8156).. controls (9.3861, 15.1873) and (9.6573, 15.6716) .. (9.3394, 15.9786)(1.5688, 23.392).. controls (1.5902, 23.4673) and (4.8551, 21.8311) .. (5.1249, 21.6854).. controls (5.575, 21.4418) and (6.0576, 21.3152) .. (6.5257, 21.113).. controls (6.8791, 20.9596) and (7.2145, 20.7744) .. (7.5466, 20.5858).. controls (8.0369, 20.307) and (9.8233, 19.7211) .. (10.1221, 19.7093).. controls (10.7346, 19.6853) and (11.0623, 19.9824) .. (11.0066, 20.6202).. controls (10.9487, 21.301) and (10.2034, 21.7411) .. (9.634, 22.048).. controls (8.8399, 22.476) and (8.0565, 22.8794) .. (7.3142, 23.3878).. controls (7.2187, 22.9048) and (7.8234, 22.6063) .. (8.1188, 22.3029).. controls (8.6393, 21.7664) and (9.1331, 21.1722) .. (9.5789, 20.5794).. controls (8.8993, 20.3774) and (8.0862, 20.8336) .. (7.5254, 21.144).. controls (7.2265, 21.3081) and (6.937, 21.4911) .. (6.619, 21.6214).. controls (6.3874, 21.7171) and (6.133, 21.7727) .. (5.9134, 21.8945).. controls (5.6745, 22.0283) and (5.5821, 22.2296) .. (5.392, 22.407).. controls (5.2146, 22.5697) and (4.9717, 22.6154) .. (4.788, 22.7922).. controls (4.4652, 23.104) and (4.042, 23.3181) .. (3.6584, 23.5581).. controls (3.2163, 23.8335) and (2.7739, 24.1108) .. (2.2965, 24.3304).. controls (1.8444, 24.5388) and (1.3646, 24.9148) .. (0.8454, 24.9436).. controls (0.1631, 24.981) and (-0.1774, 24.3551) .. (0.1164, 23.8116).. controls (0.358, 23.3645) and (0.7699, 23.4257) .. (1.1889, 23.2476).. controls (1.4898, 23.1202) and (1.7481, 22.902) .. (2.0104, 22.7182).. controls (2.5938, 22.3086) and (3.2523, 22.0797) .. (3.8815, 21.7453).. controls (4.2787, 21.5354) and (4.656, 21.2982) .. (5.0437, 21.0764).. controls (5.2372, 20.9666) and (5.4331, 20.8595) .. (5.6336, 20.7624).. controls (5.8073, 20.6779) and (6.1217, 20.6146) .. (6.2595, 20.4956).. controls (6.961, 19.8944) and (7.9867, 19.598) .. (8.3866, 18.7166).. controls (8.4374, 18.6018) and (7.873, 18.668) .. (7.8341, 18.6482).. controls (7.6843, 18.5744) and (7.6496, 18.3124) .. (7.6158, 18.1794).. controls (7.6271, 18.2251) and (6.9998, 18.5307) .. (6.9411, 18.5609).. controls (6.7666, 18.6517) and (6.0299, 18.9426) .. (5.9245, 18.6707).. controls (5.8618, 18.5067) and (6.292, 18.228) .. (6.3896, 18.14).. controls (6.66, 17.8957) and (6.8458, 17.6259) .. (7.0669, 17.3472).. controls (7.0351, 17.3881) and (6.4826, 17.0423) .. (6.3619, 17.0663).. controls (6.092, 17.1191) and (6.015, 17.4691) .. (5.9105, 17.6718).. controls (5.7043, 18.0786) and (5.404, 18.7791) .. (4.7936, 18.4511).. controls (4.4355, 18.8482) and (4.095, 19.308) .. (3.8434, 19.7718).. controls (3.7299, 19.9809) and (3.6676, 20.371) .. (3.4938, 20.5196).. controls (3.3179, 20.6694) and (3.0714, 20.6027) .. (3.0303, 20.8991).. controls (1.7941, 20.5041) and (2.2224, 18.6926) .. (2.2527, 17.757).. controls (2.2633, 17.3929) and (2.2555, 17.0304) .. (2.235, 16.6671).. controls (2.7613, 16.7164) and (3.1364, 16.8522) .. (3.2953, 17.355).. controls (3.455, 17.8576) and (3.4238, 18.4103) .. (3.4013, 18.927).. controls (3.6591, 18.825) and (3.929, 18.6264) .. (4.1331, 18.4483).. controls (4.3148, 18.2906) and (4.5407, 18.0632) .. (4.5577, 17.8238).. controls (4.576, 17.5492) and (4.5365, 17.2655) .. (4.5055, 16.9916).. controls (4.4808, 16.7664) and (4.3854, 16.791) .. (4.302, 16.6122).. controls (4.2072, 16.408) and (4.2814, 16.0659) .. (4.2406, 15.8406).. controls (4.1961, 15.6012) and (4.1154, 15.3717) .. (4.0216, 15.1457).. controls (3.9334, 14.931) and (3.8301, 14.7219) .. (3.7488, 14.5051).. controls (3.6774, 14.3135) and (3.6676, 13.8623) .. (3.5476, 13.7201).. controls (3.4938, 13.656) and (3.4139, 13.6166) .. (3.3271, 13.5827).. controls (3.2706, 13.3251) and (3.4168, 13.2561) .. (3.4005, 13.0357).. controls (3.5573, 13.0033) and (3.5406, 13.1335) .. (3.5476, 13.2413).. controls (3.5413, 13.1519) and (4.3111, 13.4335) .. (4.3712, 13.4708).. controls (4.6121, 13.6186) and (4.8043, 13.8229) .. (5.0006, 14.0178).. controls (5.2698, 14.2875) and (5.5722, 14.5656) .. (5.982, 14.6212).. controls (6.1902, 14.6501) and (6.3896, 14.5959) .. (6.5943, 14.5783).. controls (6.8614, 14.5558) and (7.1411, 14.6085) .. (7.3947, 14.5036).. controls (7.5191, 14.453) and (7.6411, 14.384) .. (7.7119, 14.2699).. controls (7.7762, 14.1657) and (7.7556, 14.0341) .. (7.82, 13.9298).. controls (7.882, 13.8313) and (8.0071, 13.7834) .. (8.0778, 13.6905).. controls (8.1605, 13.5814) and (8.205, 13.4518) .. (8.2707, 13.3349).. controls (8.3773, 13.1477) and (8.5927, 13.0329) .. (8.7142, 12.8569).. controls (8.8173, 12.7076) and (8.8365, 12.5175) .. (8.9885, 12.3986).. controls (9.129, 12.288) and (10.1758, 12.1501) .. (10.2189, 12.3507).. controls (10.3949, 13.1618) and (10.0295, 13.4962) .. (9.5599, 13.8566).. controls (9.54, 13.8721) and (9.7281, 13.925) .. (9.7655, 13.9143).. controls (9.8375, 13.8954) and (9.8608, 13.7961) .. (9.9061, 13.7517).. controls (9.966, 13.6933) and (9.9915, 13.6278) .. (10.0706, 13.5849).. controls (10.6753, 13.2575) and (11.2602, 12.9612) .. (11.9787, 12.8922).. controls (12.6172, 12.8308) and (13.5193, 12.8639) .. (13.9587, 13.3778).. controls (14.1601, 13.613) and (13.9023, 14.4565) .. (13.7893, 14.7057).. controls (13.7137, 14.8754) and (13.6069, 15.0373) .. (13.4707, 15.171).. controls (13.3146, 15.3238) and (13.3067, 15.4943) .. (13.2254, 15.6829).. controls (13.1542, 15.8504) and (12.9415, 15.9441) .. (12.8341, 16.0934).. controls (12.7246, 16.2454) and (12.642, 16.4123) .. (12.5479, 16.5728).. controls (12.4541, 16.7318) and (12.3601, 16.8938) .. (12.2307, 17.0304).. controls (12.1384, 17.1283) and (11.9984, 17.1915) .. (11.9228, 17.3029).. controls (11.8486, 17.4084) and (11.8656, 17.5782) .. (11.7767, 17.669).. controls (11.7342, 17.7112) and (11.6092, 17.7232) .. (11.5837, 17.7563).. controls (11.4432, 17.9358) and (11.4977, 18.1117) .. (11.2969, 18.2885) -- (11.2891, 18.2963) -- (11.2806, 18.3033) -- (11.2728, 18.3103) -- (11.2646, 18.3166) -- (11.2489, 18.3307) -- (11.2404, 18.3371) -- (11.2326, 18.3434) -- (11.2249, 18.3504) -- (11.2016, 18.3695).. controls (11.0695, 18.4801) and (10.9585, 18.5792) .. (10.953, 18.7736) -- (10.953, 18.7848).. controls (10.2444, 19.1277) and (9.6904, 19.4121) .. (8.8266, 19.127).. controls (7.8079, 20.0471) and (2.841, 22.7513) .. (1.5688, 23.3926) -- cycle;
%    \end{macrocode}
% \fi
%
%    \begin{macrocode}
        \end { tikzpicture }
    }
}
%    \end{macrocode}
% \end{macro}
% \makeatletter
% \renewcommand*{\@xobeysp}{\@oldxobeysp}
% \makeatother
%
% \begin{macro}{\@@_item:nnn}
%
% \changes{v2.1}{2025/05/09}{如果题名页键值对中某个条目为空，则显示空的下划线。}
%
%     带下划线的题名页键值对样式。
%    \begin{macrocode}
\cs_new:Nn \@@_item:nnn {
    #1
    \hspace { 0.5em }
    \underline {
        \begin { minipage } [ b ] {#3}
            \centering
            \rule{0pt}{0pt}
            #2
        \end { minipage }
    }
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\@@_simpleref:n}
%     简化引用函数。
%    \begin{macrocode}
\cs_new:Nn \@@_simpleref:n {
    \IfEndWith {#1} { 小节 }
        { \StrBehind {#1} { 节 } }
        {
            \IfEndWith {#1} { 节 }
                { \StrBehind {#1} { 章 } }
                {
                    \IfEndWith {#1} { ） }
                        { \StrBehind [ 2 ] {#1} { 节 } }
                        {#1}
                }
        }
}
%    \end{macrocode}
% \end{macro}
%
% \subsection{公有命令定义}
%
% \begin{macro}{\mslinespread}
%     Microsoft Word 多倍行距模拟。
%    \begin{macrocode}
\NewDocumentCommand \mslinespread { m } {
    \linespread { \fp_eval:n { #1 * \c_@@_msbaselinespread_fp / 1.2 } }
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\mslinespreadbp}
%     Microsoft Word 固定行距模拟。
%    \begin{macrocode}
\NewDocumentCommand \mslinespreadbp { m m } {
    \linespread { \fp_eval:n { #1 / #2 / 1.2 } }
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\simpleref}
%     简化引用函数。
%    \begin{macrocode}
\NewExpandableDocumentCommand \simpleref { m } {
    \hyperref [#1] { \@@_simpleref:n { \getrefnumber {#1} } }
}
%    \end{macrocode}
% \end{macro}
%
% \subsection{文档结构}
%
% \begin{macro}{\frontmatter}
%
% \changes{v2.2}{2025/05/23}{将前置部分的页面风格设置为 \texttt{fancy}。}
% \changes{v2.2}{2025/05/23}{允许章节从奇数页开始。}
%
%    \begin{macrocode}
\RenewDocumentCommand \frontmatter { } {
    \bool_if:NTF \c_@@_openright_bool
        { \cleardoublepage }
        { \clearpage }
    \pagenumbering { Roman }
    \pagestyle { fancy }
    \int_gset:Nn \c@page { 1 }
    \ctexset {
        chapter/format = {
            \mslinespread { 1 }
            \heiti
            \zihao { 3 }
            \bfseries
            \centering
        },
    }
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro} {\mainmatter}
%
% \changes{v2.2}{2025/05/23}{允许章节从奇数页开始。}
%
%    \begin{macrocode}
\RenewDocumentCommand \mainmatter { } {
    \bool_if:NTF \c_@@_openright_bool
        { \cleardoublepage }
        { \clearpage }
    \pagenumbering { arabic }
    \pagestyle { fancy }
    \int_gset:Nn \c@page { 1 }
    \int_compare:nNnT \c_@@_headingmode_int = 1 {
        \ctexset {
            chapter/format = {
                \mslinespread { 1 }
                \heiti
                \zihao { 3 }
                \bfseries
            },
        }
    }
}
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\backmatter}
%
% \changes{v2.2}{2025/05/23}{允许章节从奇数页开始。}
%
%    \begin{macrocode}
\RenewDocumentCommand \backmatter { } {
    \bool_if:NTF \c_@@_openright_bool
        { \cleardoublepage }
        { \clearpage }
    \pagestyle { fancy }
    \ctexset {
        chapter/format = {
            \mslinespread { 1 }
            \heiti
            \zihao { 3 }
            \bfseries
            \centering
        },
    }
}
%    \end{macrocode}
% \end{macro}
%
% \subsection{标题名称}
%
% \begin{macro}{\enabstractname}
%    \begin{macrocode}
\NewExpandableDocumentCommand \enabstractname { } { Abstract }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\prefacename}
%    \begin{macrocode}
\NewExpandableDocumentCommand \prefacename { } { 前言 }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\symabbrname}
%
% \changes{v2.0}{2025/04/30}{将《符号、标志、缩略语等的注释表》的命令从 \cs{symbolsandabbreviationsname} 改为 \cs{symabbrname}。}
%
%    \begin{macrocode}
\NewExpandableDocumentCommand \symabbrname { } { 符号和缩略语说明 }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\errataname}
%    \begin{macrocode}
\NewExpandableDocumentCommand \errataname { } { 勘误表 }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\acknowledgementsname}
%    \begin{macrocode}
\NewExpandableDocumentCommand \acknowledgementsname { } { 致谢 }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\resumename}
%    \begin{macrocode}
\NewExpandableDocumentCommand \resumename { }
    { 个人简历、在学期间发表的学术论文及研究成果 }
%    \end{macrocode}
% \end{macro}
%
% \begin{macro}{\anonymousresumename}
%    \begin{macrocode}
\NewExpandableDocumentCommand \anonymousresumename { }
    { 在学期间发表的学术论文及研究成果 }
%    \end{macrocode}
% \end{macro}
%
% \subsection{交叉引用}
%
%    \begin{macrocode}
\labelformat { figure    } { \figurename\thefigure                  }
\labelformat { subfigure } { \figurename\thefigure（\thesubfigure） }
\labelformat { table     } { \tablename\thetable                    }
\labelformat { equation  } { 式（\theequation）                     }
\int_compare:nNnT \c_@@_headingmode_int = 2 {
    \labelformat { chapter       } { \CTEXthechapter                  }
    \labelformat { section       } { \CTEXthechapter{}\CTEXthesection }
    \labelformat { subsection    }
        { \CTEXthechapter{}\CTEXthesection{}第\chinese{subsection}小节 }
    \labelformat { subsubsection }
        {
            \CTEXthechapter{}
            \CTEXthesection{}
            第\chinese{subsection}小节
            （\chinese{subsubsection}）
        }
}
%    \end{macrocode}
%
% \subsection{页眉页脚}
%
%    \begin{macrocode}
\pagestyle { fancy }
%    \end{macrocode}
%
% 加宽页眉横线以匹配 Microsoft Word 样式。
%
%    \begin{macrocode}
\fancyhfoffset { 1.428571pt }
\RenewExpandableDocumentCommand \headrulewidth { } { 0.7bp }
\fancyhf { }
\fancyhead [ C ] {
    \mslinespread { 1 }
    \songti
    \zihao { 5 }
    \bool_if:NTF \c_@@_uppercasehead_bool
        { \leftmark }
        { \nouppercase \leftmark }
}
\fancyfoot [ C ] { \mslinespread { 1 } \songti \zihao { 5 } \thepage }
%    \end{macrocode}
%
% \subsection{目录}
%
% 目录页使用 fancy 页眉页脚。
%
%    \begin{macrocode}
\tocloftpagestyle { fancy }
%    \end{macrocode}
%
% 设置点间距。
%
%    \begin{macrocode}
\RenewExpandableDocumentCommand \cftdotsep { } { 1 }
%    \end{macrocode}
%
% 设置章标题格式。
%
%    \begin{macrocode}
\dim_set:Nn \cftbeforechapskip { 2bp }
\RenewExpandableDocumentCommand \cftchapfont     { }
    { \mslinespread { 1 } \songti \zihao { 4 } }
\RenewExpandableDocumentCommand \cftchappagefont { }
    { \cftchapfont                             }
\RenewExpandableDocumentCommand \cftchapleader   { }
    { \cftdotfill { \cftdotsep }               }
%    \end{macrocode}
%
% 设置节标题格式。
%
%    \begin{macrocode}
\dim_set:Nn \cftbeforesecskip { 2bp   }
\dim_set:Nn \cftsecindent     { \ccwd }
\RenewExpandableDocumentCommand \cftsecfont     { }
    { \mslinespread { 1 } \songti \zihao { -4 } }
\RenewExpandableDocumentCommand \cftsecpagefont { }
    { \cftsecfont                               }
%    \end{macrocode}
%
% 设置小节标题格式。
%
%    \begin{macrocode}
\dim_set:Nn \cftbeforesubsecskip { 2bp    }
\dim_set:Nn \cftsubsecindent     { 2\ccwd }
\RenewExpandableDocumentCommand \cftsubsecfont     { }
    { \mslinespread { 1 } \songti \zihao { 5 } }
\RenewExpandableDocumentCommand \cftsubsecpagefont { }
    { \cftsubsecfont                           }
%    \end{macrocode}
%
% 设置图表标题格式。
%
%    \begin{macrocode}
\dim_set:Nn \cftbeforefigskip { 2bp      }
\dim_set:Nn \cftbeforetabskip { 2bp      }
\dim_set:Nn \cftfignumwidth   { 3.5\ccwd }
\dim_set:Nn \cfttabnumwidth   { 3.5\ccwd }
\dim_set:Nn \cftfigindent     { 0pt      }
\dim_set:Nn \cfttabindent     { 0pt      }
\RenewExpandableDocumentCommand \cftfigfont    { }
    { \mslinespread { 1 } \songti \zihao { -4 } }
\RenewExpandableDocumentCommand \cfttabfont    { }
    { \mslinespread { 1 } \songti \zihao { -4 } }
\RenewExpandableDocumentCommand \cftfigpresnum { }
    { \figurename                               }
\RenewExpandableDocumentCommand \cfttabpresnum { }
    { \tablename                                }
%    \end{macrocode}
%
% \subsection{\CTeX 设置}
%
%    \begin{macrocode}
\ctexset {
    listfigurename = 插图清单,
    listtablename  = 附表清单,
    chapter = {
        fixskip    = true,
        beforeskip = 24bp,
        afterskip  = 26bp,
        aftername  = \hspace { \ccwd },
        pagestyle  = fancy,
        tocline    = {
            \CTEXifname{\protect{\csname CTEXthe#1\endcsname\hspace{\ccwd}}}{}#2
        },
    },
    section = {
        fixskip    = true,
        beforeskip = 32bp,
        afterskip  = 14bp,
        aftername  = \hspace { \ccwd },
        tocline    = {
            \CTEXifname{\protect{\csname CTEXthe#1\endcsname\hspace{\ccwd}}}{}#2
        },
    },
    subsection = {
        fixskip    = true,
        format     = {
            \mslinespread { 1 }
            \heiti
            \fontsize { 13bp } { 15.6bp }
            \selectfont
        },
        beforeskip = 20bp,
        afterskip  = 14bp,
        tocline    = \CTEXifname{\protect{\csname CTEXthe#1\endcsname}}{}#2,
    },
    subsubsection = {
        fixskip    = true,
        format     = \mslinespread { 1 } \heiti \zihao { -4 },
        beforeskip = 20bp,
        afterskip  = 14bp,
    },
}
%    \end{macrocode}
%
% 根据标题模式设置不同格式。
%
%    \begin{macrocode}
\int_compare:nNnTF \c_@@_headingmode_int = 1
    {
        \ctexset {
            chapter = {
                name      = { },
                number    = \arabic { chapter },
                format    = \mslinespread { 1 } \heiti \zihao { 3 } \bfseries,
            },
            section = {
                number    = \arabic{chapter}.\arabic{section},
                format    = \mslinespread { 1 } \heiti \zihao { 4 } \bfseries,
            },
            subsection = {
                number    = {
                    \arabic{chapter}.\arabic{section}.
                    \arabic{subsection}
                },
                aftername = \hspace { \ccwd }
            },
            subsubsection = {
                number    = {
                    \arabic{chapter}.\arabic{section}.
                    \arabic{subsection}.\arabic{subsubsection}
                },
                aftername = \hspace { \ccwd },
            },
        }
    }
    {
        \ctexset {
            chapter/format = {
                \mslinespread { 1 }
                \heiti
                \zihao { 3 }
                \bfseries
                \centering
            },
            section = {
                name      = { 第, 节 },
                number    = \chinese{section},
                format    = {
                    \mslinespread { 1 }
                    \heiti
                    \zihao { 4 }
                    \bfseries
                    \centering
                },
            },
            subsection = {
                name      = { , 、 },
                number    = \chinese{subsection},
                indent    = \parindent,
                aftername = { },
            },
            subsubsection = {
                name      = { （, ） },
                number    = \chinese{subsubsection},
                indent    = \parindent,
                aftername = { },
            },
        }
    }
%    \end{macrocode}
%
% \subsection{图表}
%
%    \begin{macrocode}
\DeclareCaptionLabelFormat    { nkthesis    } { #1#2              }
\DeclareCaptionLabelFormat    { nkthesissub } { （#2）            }
\DeclareCaptionLabelSeparator { nkthesis    } { \hspace { \ccwd } }
\DeclareCaptionFont           { nkthesis    }
    { \mslinespread { 1 } \songti \zihao { 5 } }
\captionsetup {
    labelsep    = nkthesis,
    labelformat = nkthesis,
    font        = nkthesis,
    skip        = 6bp,
}
\subcaptionsetup {
    labelsep    = none,
    labelformat = nkthesissub,
    font        = nkthesis,
    skip        = 6bp,
}
\dim_set:Nn \textfloatsep { 20bp }
\dim_set:Nn \floatsep     { 20bp }
\dim_set:Nn \intextsep    { 20bp }
%    \end{macrocode}
%
% \subsection{公式}
%
% 设置公式标签格式。
%
%    \begin{macrocode}
\cs_set:Npn \tagform@ #1 {
    \maketag@@@@@ {
        \ignorespaces
        \mslinespread { 1 }
        \songti
        \zihao { 5 }
        （#1）
        \unskip
        \@@@@italiccorr
    }
}
%    \end{macrocode}
%
% 减小公式行距。
%
%    \begin{macrocode}
\AtBeginEnvironment { equation } { \singlespace }
%    \end{macrocode}
%
% \subsection{列表}
%
%    \begin{macrocode}
\setlist  [ enumerate ] { nosep, wide }
\setlist  [ itemize   ] { nosep, wide }
%    \end{macrocode}
%
% \begin{environment}{inlineenumerate}
%    \begin{macrocode}
\newlist  { inlineenumerate } { enumerate* } { 1 }
\setlist* [ inlineenumerate ] { mode = unboxed, label = （\arabic*） }
%    \end{macrocode}
% \end{environment}
%
% \begin{environment}{inlineitemize}
%    \begin{macrocode}
\newlist  { inlineitemize } { itemize* } { 1 }
\setlist* [ inlineitemize ] { label = \textbullet }
%    \end{macrocode}
% \end{environment}
%
% \subsection{附录}
%
% \begin{macro}{\appendix}
%
% \changes{v2.0}{2025/05/01}{修正附录中图、表、公式标签格式。从A.1改为A1。}
%
% 更改附录中图、表、公式标签格式。
% 从A.1改为A1。
%
%    \begin{macrocode}
\apptocmd { \appendix }
    {
        \RenewExpandableDocumentCommand \thefigure { }
            { \thechapter \arabic { figure } }
        \RenewExpandableDocumentCommand \thetable { }
            { \thechapter \arabic { table } }
        \RenewExpandableDocumentCommand \theequation { }
            { \thechapter \arabic { equation } }
    }
    { }
    { }
%    \end{macrocode}
% \end{macro}
%
% \subsection{参考文献}
%
%    \begin{macrocode}
\AtBeginBibliography { \mslinespreadbp { 16 } { 10.5 } \songti \zihao { 5 } }
%    \end{macrocode}
%
% \subsection{自定义环境}
%
% \subsubsection{摘要}
%
% \begin{environment}{abstract, enabstract}
%
% \changes{v2.2}{2025/05/23}{让页眉符合 \texttt{uppercasehead} 设置。}
%
%    \begin{macrocode}
\NewDocumentEnvironment { abstract } { }
    {
        \ctexset{
            chapter/format = {
                \mslinespread { 1 }
                \heiti
                \zihao { -2 }
                \bfseries
                \centering
            },
        }
        \chapter* { \abstractname }
        \markboth
            { \MakeUppercase { \abstractname } }
            { \MakeUppercase { \abstractname } }
        \ignorespaces
    }
    { }
\NewDocumentEnvironment { enabstract } { }
    {
        \ctexset{
            chapter/format = {
                \mslinespread { 1 }
                \arial
                \zihao { -2 }
                \bfseries
                \centering
            },
        }
        \chapter* { \enabstractname }
        \markboth
            { \MakeUppercase { \enabstractname  } }
            { \MakeUppercase { \enabstractname  } }
        \ignorespaces
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \begin{environment}{keywords, enkeywords}
%    \begin{macrocode}
\NewDocumentEnvironment { keywords } { }
    {
        \songti \textbf { 关键词： } \ignorespaces
    }
    { }
\NewDocumentEnvironment { enkeywords } { }
    {
        \textbf { Key~Words:~ } \ignorespaces
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \subsubsection{序言或前言}
%
% \begin{environment}{preface}
%
% \changes{v2.2}{2025/05/23}{让页眉符合 \texttt{uppercasehead} 设置。}
%
%    \begin{macrocode}
\NewDocumentEnvironment { preface } { }
    {
        \ctexset{
            chapter/format = {
                \mslinespread { 1 }
                \heiti
                \zihao { 3 }
                \bfseries
                \centering
            },
        }
        \chapter* { \prefacename }
        \markboth
            { \MakeUppercase { \prefacename  } }
            { \MakeUppercase { \prefacename  } }
        \ignorespaces
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \subsubsection{符号、标志、缩略语等的注释表}
%
% \begin{environment}{symabbr}
%
% \changes{v2.0}{2025/04/30}{将《符号、标志、缩略语等的注释表》的环境从 \env{symbolsandabbreviations} 改为 \env{symabbr}。}
% \changes{v2.2}{2025/05/23}{让页眉符合 \texttt{uppercasehead} 设置。}
%
%    \begin{macrocode}
\NewDocumentEnvironment { symabbr } { }
    {
        \ctexset{
            chapter/format = {
                \mslinespread { 1 }
                \heiti
                \zihao { 3 }
                \bfseries
                \centering
            },
        }
        \chapter* { \symabbrname }
        \markboth
            { \MakeUppercase { \symabbrname  } }
            { \MakeUppercase { \symabbrname  } }
        \mslinespreadbp { 16 } { 10.5 }
        \songti
        \zihao { 5 }
        \ignorespaces
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \subsubsection{勘误页}
%
% \begin{environment}{errata}
%
% \changes{v2.2}{2025/05/23}{让页眉符合 \texttt{uppercasehead} 设置。}
%
%    \begin{macrocode}
\NewDocumentEnvironment { errata } { }
    {
        \ctexset{
            chapter/format = {
                \mslinespread { 1 }
                \heiti
                \zihao { 3 }
                \bfseries
                \centering
            },
        }
        \chapter* { \errataname }
        \markboth
            { \MakeUppercase { \errataname } }
            { \MakeUppercase { \errataname } }
        \mslinespreadbp { 16 } { 12 } \songti \zihao { -4 }
        \addcontentsline { toc } { chapter } { \errataname }
        \ignorespaces
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \subsubsection{致谢}
%
% \begin{environment}{acknowledgements}
%
% \changes{v2.2}{2025/05/23}{让页眉符合 \texttt{uppercasehead} 设置。}
%
%    \begin{macrocode}
\NewDocumentEnvironment { acknowledgements } { }
    {
        \ctexset{
            chapter/format = {
                \mslinespread { 1 }
                \heiti
                \zihao { 3 }
                \bfseries
                \centering
            },
        }
        \chapter* { \acknowledgementsname }
        \markboth
            { \MakeUppercase { \acknowledgementsname } }
            { \MakeUppercase { \acknowledgementsname } }
        \mslinespreadbp { 16 } { 12 }
        \songti
        \zihao { -4 }
        \addcontentsline { toc } { chapter } { \acknowledgementsname }
        \ignorespaces
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \subsubsection{个人简历、在学期间发表的学术论文及研究成果}
%
% \begin{macro}{\@@_resume:n}
%
% \changes{v2.2}{2025/05/23}{让页眉符合 \texttt{uppercasehead} 设置。}
%
%    \begin{macrocode}
\cs_new:Nn \@@_resume:n {
    \ctexset{
        chapter/format = {
            \mslinespread { 1 }
            \heiti
            \zihao { 3 }
            \bfseries
            \centering
        },
    }
    \chapter* {#1}
    \markboth
        { \MakeUppercase {#1} }
        { \MakeUppercase {#1} }
    \mslinespreadbp { 16 } { 10.5 }
    \songti
    \zihao { 5 }
    \addcontentsline { toc } { chapter } {#1}
    \ignorespaces
}
%    \end{macrocode}
% \end{macro}
%
% \begin{environment}{resume}
%    \begin{macrocode}
\NewDocumentEnvironment { resume } { }
    {
        \@@_resume:n { \resumename }
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \begin{environment}{resume*}
%    \begin{macrocode}
\NewDocumentEnvironment { resume* } { }
    {
        \@@_resume:n { \anonymousresumename }
    }
    { }
%    \end{macrocode}
% \end{environment}
%
% \subsection{自定义页面}
%
% \subsubsection{题名页}
%
% \begin{macro}{\titlepage}
%
% \changes{v2.1}{2025/05/09}{修复二级学科为空时学科专业不能正常显示一级学科的问题。}
% \changes{v2.2}{2025/05/23}{允许章节从奇数页开始。}
%
%    \begin{macrocode}
\RenewDocumentCommand \titlepage { } {
    \bool_if:NTF \c_@@_openright_bool
        { \cleardoublepage }
        { \clearpage }
    \pagestyle { empty }
    \group_begin:
    \dim_set:Nn \parindent { 0pt }
    \par

    {
        \mslinespread { 1 }
        \songti
        \zihao { 5 }
        \RenewExpandableDocumentCommand \arraystretch { } { 1.25 }
        \begin { tabular } {
            > { \raggedleft  \arraybackslash                   } p { 20.7mm }
            > { \raggedright \arraybackslash \hspace { 2.3mm } } p { 62.7mm }
            > { \raggedleft  \arraybackslash                   } p { 20.7mm }
            > { \raggedright \arraybackslash \hspace { 2.3mm } } p { 25mm   }
        }
            中图分类号： & \nktget { 中图分类号  } &
            学校代码：   & \nktget { 学校代码    } \\
            UDC：        & \nktget { UDC         } &
            密级：       & \nktget { 题名页/密级 } \\
        \end { tabular }
        \par
    }
    \par

    \vspace { 0.6mm }
    \begin { center }
        \@@_nankai_logo:n { 1 }
        \par

        \vspace { -1.5mm }
        {
            \mslinespread { 1 }
            \songti
            \zihao { 2 }
            \bfseries
            \ziju { 0.5 }
            \tl_use:N \g_@@_lunwenleibie_tl 学位论文
            \par
        }
        \par

        \vspace { 11.5mm }
        \begin { minipage } [ t ] [ 80mm ] { \linewidth }
            \centering
            \mslinespread { 1.5 }
            \songti
            \zihao { \nktget { 题名页/论文题目字号 } }
            \nktget { 论文题目（中文） }
            \par

            \nktget { 论文副标题 }
            \par

            \nktget { 论文题目（英文） }
            \par
        \end { minipage }
        \par

        \vspace { 10mm }
        {
            \mslinespread { 1 }
            \songti
            \zihao { -4 }
            \RenewExpandableDocumentCommand \arraystretch { } { 2 }
            \dim_set:Nn \tabcolsep { 0pt }
            \begin { tabular } {
                > { \centering \arraybackslash } p { 70mm }
                > { \centering \arraybackslash } p { 70mm }
            }
                \@@_item:nnn { 论文作者 }
                    { \nktget { 论文作者 } }
                    { 38.2mm } &
                \@@_item:nnn { 指导教师 }
                    { \nktget { 指导教师 } \quad \nktget { 指导教师职称 } }
                    { 38.2mm } \\

                \@@_item:nnn { 申请学位 }
                    { \nktget { 申请学位 } }
                    { 38.2mm } &
                \@@_item:nnn { 培养单位 }
                    { \nktget { 培养单位 } }
                    { 38.2mm } \\

                \@@_item:nnn { 学科专业 }
                    {
                        \tl_if_empty:eTF { \nktget { 二级学科 } }
                            { \nktget { 一级学科 } }
                            { \nktget { 二级学科 } }
                    }
                    { 38.2mm } &
                \@@_item:nnn { 研究方向 }
                    { \nktget { 研究方向 } }
                    { 38.2mm } \\

                \@@_item:nnn { 答辩委员会主席 }
                    { \nktget { 答辩委员会主席 } }
                    { 25.5mm } &
                \@@_item:nnn { 评阅人 }
                    { \nktget{ 评阅人 } }
                    { 42.4mm } \\
            \end { tabular }
            \par
        }
        \par

        \vspace { 14.5mm }
        {
            \mslinespread { 1.69 }
            \songti
            \zihao { 4 }
            南开大学研究生院
            \par

            \nktget { 论文完成时间 }
            \par
        }
    \end { center }
    \group_end:
}
%    \end{macrocode}
% \end{macro}
%
% \subsubsection{匿名评阅封面}
%
% \begin{macro}{\anonymoustitlepage}
%
% \changes{v2.2}{2025/05/23}{允许章节从奇数页开始。}
%
%    \begin{macrocode}
\NewDocumentCommand \anonymoustitlepage { } {
    \bool_if:NTF \c_@@_openright_bool
        { \cleardoublepage }
        { \clearpage }
    \pagestyle { empty }
    \group_begin:
    \dim_set:Nn \parindent { 0pt }
    \vspace* { 5mm }
    \begin { center }
        \@@_nankai_logo:n { 1.97 }
        \par

        \vspace { 5.5mm }
        {
            \mslinespread { 1 }
            \heiti
            \fontsize { 28 } { 33.6 }
            \bfseries
            南开大学 \tl_use:N \g_@@_lunwenleibie_tl 毕业（学位）论文
            \par
        }
        \par

        \vspace { 10mm }
        {
            \mslinespread { 1 }
            \fangsong
            \zihao { -2 }
            （匿名评阅封面）
            \par
        }
        \par

        \vspace { 21mm }
        {
            \mslinespread { 1.53 }
            \kaishu
            \zihao { 3 }
            \begin { minipage } { 0.73\linewidth }
                论文题目：
            \end { minipage }
            \par

            \begin { minipage } [ t ] [ 54.9mm ] { \linewidth }
                \centering
                \nktget { 论文题目（中文） }
                \par

                \nktget { 论文副标题 }
                \par

                \nktget { 论文题目（英文） }
                \par
            \end { minipage }
            \par

            \begin { minipage } { 0.73\linewidth }
                一级学科：\nktget { 一级学科 }
                \par

                二级学科：\nktget { 二级学科 }
                \par

                \vspace { 11mm }
                论文编号：\nktget { 论文编号 }
                \par
            \end { minipage }
            \par
        }
    \end { center }
    \group_end:
}
%    \end{macrocode}
% \end{macro}
%
% \subsubsection{学位论文原创性声明和非公开学位论文标注说明}
%
% \begin{macro}{\declarationpage}
%
% \changes{v2.2}{2025/05/23}{允许章节从奇数页开始。}
%
%    \begin{macrocode}
\NewDocumentCommand \declarationpage { } {
    \bool_if:NTF \c_@@_openright_bool
        { \cleardoublepage }
        { \clearpage }
    \group_begin:
    \ctexset {
        chapter/format    = \mslinespread{1}\heiti\zihao{3}\bfseries\centering,
        chapter/pagestyle = empty,
    }
    \chapter* { 南开大学学位论文原创性声明 }
    \par

    \vspace { 2mm }
    {
        \mslinespread { 1.5 }
        \songti
        \zihao { -4 }
        本人郑重声明：所呈交的学位论文，是本人在导师指导下进行研究工作所取得的研
        究成果。除文中已经注明引用的内容外，本学位论文的研究成果不包含任何他人创
        作的、已公开发表或者没有公开发表的作品的内容。对本论文所涉及的研究工作做
        出贡献的其他个人和集体，均已在文中以明确方式标明。本学位论文原创性声明的
        法律责任由本人承担。
        \par
    }
    \par

    \vspace { 13.5mm }
    学位论文作者签名：
    \hspace { 0.5em }
    \underline { \hbox to 40mm { } }
    \hfill 年 \qquad 月 \qquad 日 \hspace* { \ccwd }
    \par

    \vspace { -0.4\baselineskip }
    \noindent
    \begin { tikzpicture }
    \foreach \x in { 0, 0.2, ..., 14.4 } {
        \draw [ thick ] ( \x, 0 ) -- ++ ( 0.1, 0 );
    }
    \end { tikzpicture }
    \par

    \vspace { 1mm }
    \begin { center }
        {
            \mslinespread { 1 }
            \heiti
            \zihao { 3 }
            非公开学位论文标注说明
            \par
        }
        \par

        \vspace { 2.4mm }
        {
            \mslinespread { 1 }
            \kaishu
            \zihao { -4 }
            （本页表中填写内容须打印）
            \par
        }
    \end { center }
    \par

    \vspace { -6mm }
    {
        \mslinespread { 1.5 }
        \songti
        \zihao { -4 }
        根据南开大学有关规定，非公开学位论文须经指导教师同意、作者本人申请和相关
        部门批准方能标注。
        { \heiti 未经批准的均为公开学位论文，公开学位论文本说明为空白 }。
        \par
    }
    \par

    \vspace { 2mm }
    {
        \mslinespread { 1 }
        \zihao { -4 }
        \RenewExpandableDocumentCommand \arraystretch { } { 1.78 }
        \noindent
        \begin { tabular } { | c | c | }
            \hline
            \begin { minipage } [ c ] [ 17.7mm ] { 26mm }
                \centering
                { \heiti 论文题目 }
            \end { minipage } &
            \str_if_eq:eeTF { \tl_use:N \g_@@_shenqingmiji_tl } {公开}
                {
                    \begin { minipage } { 111mm }
                        \rule{0pt}{0pt}
                    \end { minipage }
                }
                {
                    \begin { minipage } { 111mm }
                        \nktget { 论文题目（中文） }
                        \nktget { 论文副标题 }
                    \end {minipage }
                } \\
            \hline
            { \heiti 申请密级 } &
            \@@_ifcheckbox:nn { \tl_use:N \g_@@_shenqingmiji_tl } { 限制 }
                ~限制（$\leq 2$年）
                \quad
            \@@_ifcheckbox:nn { \tl_use:N \g_@@_shenqingmiji_tl } { 秘密 }
                ~秘密（$\leq 10$年）
                \quad
            \@@_ifcheckbox:nn { \tl_use:N \g_@@_shenqingmiji_tl } { 机密 }
                ~机密（$\leq 20$年） \\
            \hline
            { \heiti 保密期限 } &
            \str_if_eq:eeTF { \tl_use:N \g_@@_shenqingmiji_tl } { 公开 }
                {
                    20 \qquad 年 \qquad 月 \qquad 日
                    至20 \qquad 年 \qquad 月 \qquad 日
                }
                {
                    \nktget { 非公开论文/保密期限/起始日期 } 至
                    \nktget { 非公开论文/保密期限/结束日期 }
                } \\
            \hline
            { \heiti 审批表编号 } &
            \hbox to 42mm {
                \str_if_eq:eeF { \tl_use:N \g_@@_shenqingmiji_tl } { 公开 }
                    { \nktget { 非公开论文/审批表编号 } }
            }
            \vline
            \hbox to 24mm { \hfill \heiti 批准日期 \hfill }
            \vline
            \hfill{
                \str_if_eq:eeTF { \tl_use:N \g_@@_shenqingmiji_tl } { 公开 }
                    { 20 \qquad 年 \qquad 月 \qquad 日 }
                    { \nktget { 非公开论文/批准日期 } }
            } \\
            \hline
        \end { tabular }
        \par
    }
    \par

    \vspace { 1.7mm }
    \hfill
    { \heiti 南开大学学位评定委员会办公室盖章（有效） }
    \par

    \vspace { 9.5mm }
    {
        \mslinespread { 1 }
        \songti
        \zihao { 5 }
        \noindent
        { \heiti 注： }
        限制★2年（可少于2年）；秘密★10年（可少于10年）；机密★20年（可少于20年）
        \par
    }
    \group_end:
}
%    \end{macrocode}
% \end{macro}
%
% \subsubsection{学位论文使用授权书}
%
% \begin{macro}{\authorizationpage}
%
% \changes{v2.1}{2025/05/09}{修复二级学科为空时学科专业不能正常显示一级学科的问题。}
% \changes{v2.2}{2025/05/23}{允许章节从奇数页开始。}
%
%    \begin{macrocode}
\NewDocumentCommand \authorizationpage { } {
    \bool_if:NTF \c_@@_openright_bool
        { \cleardoublepage }
        { \clearpage }
    \group_begin:
    \ctexset {
        chapter/format    = \mslinespread{1}\heiti\zihao{3}\centering,
        chapter/pagestyle = empty,
    }
    \chapter* { 南开大学学位论文使用授权书 }
    \par

    \vspace { -7.1mm }
    {
        \mslinespread { 1.16 }
        \songti
        \zihao { 5 }
        \dim_set:Nn \parskip { 2.6mm }
        \par

        本人完全了解《南开大学关于研究生学位论文收藏和利用管理办法》关于南开大学
        （简称“学校”）研究生学位论文收藏和利用的管理规定，即：
        \par

        南开大学拥有在著作权法规定范围内学位论文的使用权，其中包括：
        \par

        已获学位的研究生必须按学校规定提交学位论文，学校可以采用影印、缩印或其他
        复制手段保存学位论文；学校根据规定向教育部指定的收藏和存档单位提交学位论
        文；
        \par

        为教学和科研目的，学校可以将公开的学位论文作为资料在图书馆、资料室等场所
        供校内师生阅读，或在校园网范围内供师生检索、浏览；
        \par

        非公开学位论文在解密后的使用权同公开论文。
        \par

        本人承诺：本人的学位论文是在南开大学学习期间创作完成的作品，并已通过论文
        答辩；提交的学位论文电子版与纸质本论文的内容一致，如因不同造成不良后果由
        本人自负。
        \par

        本人签署本授权书一份（此授权书为论文中一页），交图书馆留存。
        \par

        \vspace { 8.3mm }
        \hfill 学位论文作者暨授权人（亲笔）签字：\hbox to 35.2mm { }
        \par

        \hfill \nktget { 授权书/签字日期 }
        \par
    }
    \par

    \vspace { 16mm }
    \begin { center }
        \mslinespread { 1 }
        \heiti
        \zihao { 4 }
        南开大学研究生学位论文作者信息
    \end { center }
    \par

    \vspace { -3.6mm }
    {
        \mslinespread { 1 }
        \songti
        \zihao { 5 }
        \RenewExpandableDocumentCommand \arraystretch { } { 1.343 }
        \hspace { -18.5mm }
        \dim_set:Nn \tabcolsep { 0pt }
        \begin { tabular } { | l | }
            \hline
            \hbox to 22mm { \hspace { 0.3em } \textbf { 论文题目 } }~
            \vrule
            \hbox to 144.9mm { \hspace { 0.3em } \nktget { 论文题目（中文） }
            \nktget { 论文副标题 } \hfill } \\
            \hline
            \hbox to 22mm { \hspace { 0.3em } \textbf { 姓名 } }~
            \vrule
            \hbox to 30.2mm { \hspace { 0.3em } \nktget { 论文作者 } \hfill }~
            \vrule
            \hbox to 18.7mm { \hspace { 0.3em } \textbf {学号} }~
            \vrule
            \hbox to 24.6mm { \hspace { 0.3em } \nktget { 学号 } \hfill }~
            \vrule
            \hbox to 19.5mm { \hspace { 0.3em } \textbf { 答辩日期 } }~
            \vrule
            \hbox to 40mm { \hspace { 0.3em } \nktget { 答辩日期 } \hfill } \\
            \hline
            \hbox to 22mm { \hspace { 0.3em } \textbf { 论文类别 } }~
            \vrule
            \hbox to 144.9mm {
                \hspace { 2em }
                博士~\@@_ifcheckbox:nn
                    { \tl_use:N \g_@@_lunwenleibiealt_tl }
                    { 博士 }
                \qquad
                学历硕士~\@@_ifcheckbox:nn
                    { \tl_use:N \g_@@_lunwenleibiealt_tl }
                    { 学历硕士 }
                \qquad
                专业学位硕士~\@@_ifcheckbox:nn
                    { \tl_use:N \g_@@_lunwenleibiealt_tl }
                    { 专业学位硕士 }
                \qquad
                同等学力硕士~\@@_ifcheckbox:nn
                    { \tl_use:N \g_@@_lunwenleibiealt_tl }
                    { 同等学力硕士 }
                \hfill
                划 \@@_ifcheckbox:nn {true} {true} 选择
                \hspace { 0.3em }
            } \\
            \hline
            \hbox to 22mm { \hspace { 0.3em } \textbf { 学院（单位） } }~
            \vrule
            \hbox to 47.9mm { \hspace { 0.3em } \nktget { 培养单位 } \hfill }~
            \vrule
            \hbox to 47.6mm { \hspace { 0.3em } \textbf { 学科/专业（专业学位）名称 } }~
            \vrule
            \hbox to 34mm {
                \hspace { 0.3em }
                \tl_if_empty:eTF { \nktget { 二级学科 } }
                    { \nktget { 一级学科 } }
                    { \nktget { 二级学科 } }
                \hfill
            } \\
            \hline
            \hbox to 22mm { \hspace { 0.3em } \textbf { 联系电话 } }~
            \vrule
            \hbox to 47.9mm { \hspace { 0.3em } \nktget { 联系电话 } \hfill }~
            \vrule
            \hbox to 20mm { \hspace { 0.3em } \textbf { 电子邮箱 } }~
            \vrule
            \hbox to 34mm { \hspace { 0.3em } \nktget { 电子邮箱 } \hfill } \\
            \hline
            \hspace{ 0.3em } \textbf { 通讯地址（邮编）： } \nktget { 通讯地址 } \hfill \\
            \hline
            \hbox to 31.3mm { \hspace { 0.3em } \textbf { 非公开论文编号 } }~
            \vrule
            \hbox to 40.7mm { \hspace { 0.3em } \nktget { 非公开论文/审批表编号 } \hfill }~
            \vrule
            \hbox to 10.3mm { \hspace { 0.3em } \textbf { 备注 } }~
            \vrule
            \hbox to 32mm { \hspace { 0.3em } \nktget { 作者信息/备注 } \hfill } \\
            \hline
        \end { tabular }
        \par
    }
    \par

    \vspace { 1.8mm }
    {
        \mslinespread { 1.3 }
        \heiti
        \zihao { -5 }
        \hspace { -18.5mm }
        \dim_set:Nn \tabcolsep { 0pt }
        \begin { tabular }
            { > { \raggedleft \arraybackslash } p { 7.1mm } p { 1.3mm } p { 160mm } }
            注：& & 本授权书适用我校授予的所有博士、硕士的学位论文。如已批准为非
            公开学位论文，须向图书馆提供批准通过的《南开大学研究生申请非公开学位
            论文审批表》复印件和“非公开学位论文标注说明”页原件。\\
        \end { tabular }
        \par
    }
    \group_end:
}
%    \end{macrocode}
% \end{macro}
%
% \subsubsection{参考文献}
%
% \begin{macro}{\bibliographypage}
%    \begin{macrocode}
\NewDocumentCommand \bibliographypage { } {
    \printbibliography [ heading = bibintoc, title = \bibname ]
}
%    \end{macrocode}
% \end{macro}
%
% \end{implementation}
%
% \Finale
\endinput
